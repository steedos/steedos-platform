{"version":3,"sources":["meteor://ğŸ’»app/packages/steedos_object-database/models/object.coffee","meteor://ğŸ’»app/models/object.coffee","meteor://ğŸ’»app/packages/steedos_object-database/models/object_fields.coffee","meteor://ğŸ’»app/models/object_fields.coffee","meteor://ğŸ’»app/packages/steedos_object-database/models/object_triggers.coffee","meteor://ğŸ’»app/models/object_triggers.coffee","meteor://ğŸ’»app/packages/steedos_object-database/models/object_actions.coffee","meteor://ğŸ’»app/models/object_actions.coffee"],"names":["isRepeatedName","doc","other","Creator","getCollection","find","_id","$ne","space","name","fields","count","Objects","objects","icon","label","type","searchable","index","required","regEx","SimpleSchema","RegEx","code","optionsFunction","options","_","forEach","resources","sldsIcons","standard","svg","push","value","is_enable","defaultValue","enable_search","enable_files","enable_tasks","enable_notes","enable_events","enable_api","hidden","enable_share","enable_instances","enable_chatter","enable_audit","enable_trash","enable_space_global","enable_approvals","is_view","omit","description","is_wide","sidebar","blackbox","list_views","actions","permission_set","triggers","custom","owner","app_unique_id","app_version","all","columns","filter_scope","user","allowCreate","allowDelete","allowEdit","allowRead","modifyAllRecords","viewAllRecords","admin","copy_odata","visible","on","todo","object_name","record_id","item_element","clipboard","o_name","path","record","getObjectById","SteedosOData","getODataPath","Session","get","attr","Clipboard","e","toastr","success","error","console","tagName","hasClass","trigger","when","userId","log","Meteor","Error","fieldNames","modifier","ref","$set","$unset","insert","object","shared","documents","object_collections","direct","remove","Collections","_collection","dropCollection","stack","_syncToObject","object_fields","table_fields","created","modified","created_by","modified_by","fetch","f","cf_arr","child_fields","test","split","size","extend","each","k","update","field","is_name","reference_to","_options","objectsByName","o","text","textarea","html","select","boolean","date","datetime","number","currency","password","lookup","master_detail","grid","url","email","sort_no","scale","sortable","group","allowedValues","multiple","readonly","precision","rows","sort","field_name","order","_reference_to","object_documents","ref1","ref2","ref3","ref4","ref5","ref6","ref7","length","findOne","check","object_triggers","Steedos","isSpaceAdmin","isLegalVersion","object_actions"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA,IAAAA,cAAA;;AAAAA,iBAAiB,UAACC,GAAD;AAChB,MAAAC,KAAA;AAAAA,UAAQC,QAAQC,aAAR,CAAsB,SAAtB,EAAiCC,IAAjC,CAAsC;AAACC,SAAK;AAACC,WAAKN,IAAIK;AAAV,KAAN;AAAsBE,WAAOP,IAAIO,KAAjC;AAAwCC,UAAMR,IAAIQ;AAAlD,GAAtC,EAA+F;AAACC,YAAO;AAACJ,WAAK;AAAN;AAAR,GAA/F,CAAR;;AACA,MAAGJ,MAAMS,KAAN,KAAgB,CAAnB;AACC,WAAO,IAAP;ACaC;;ADZF,SAAO,KAAP;AAJgB,CAAjB;;AAMAR,QAAQS,OAAR,CAAgBC,OAAhB,GACC;AAAAJ,QAAM,SAAN;AACAK,QAAM,QADN;AAEAC,SAAO,IAFP;AAGAL,UACC;AAAAD,UACC;AAAAO,YAAM,MAAN;AACAC,kBAAW,IADX;AAEAC,aAAM,IAFN;AAGAC,gBAAU,IAHV;AAIAC,aAAOC,aAAaC,KAAb,CAAmBC;AAJ1B,KADD;AAMAR,WACC;AAAAC,YAAM,MAAN;AACAG,gBAAU;AADV,KAPD;AASAL,UACC;AAAAE,YAAM,QAAN;AACAQ,uBAAiB;AAChB,YAAAC,OAAA;AAAAA,kBAAU,EAAV;;AACAC,UAAEC,OAAF,CAAUxB,QAAQyB,SAAR,CAAkBC,SAAlB,CAA4BC,QAAtC,EAAgD,UAACC,GAAD;ACkB1C,iBDjBLN,QAAQO,IAAR,CAAa;AAACC,mBAAOF,GAAR;AAAahB,mBAAOgB,GAApB;AAAyBjB,kBAAMiB;AAA/B,WAAb,CCiBK;ADlBN;;AAEA,eAAON,OAAP;AALD;AAAA,KAVD;AAgBAS,eACC;AAAAlB,YAAM,SAAN;AACAmB,oBAAc;AADd,KAjBD;AAmBAC,mBACC;AAAApB,YAAM;AAAN,KApBD;AAqBAqB,kBACC;AAAArB,YAAM;AAAN,KAtBD;AAuBAsB,kBACC;AAAAtB,YAAM;AAAN,KAxBD;AAyBAuB,kBACC;AAAAvB,YAAM;AAAN,KA1BD;AA2BAwB,mBACC;AAAAxB,YAAM;AAAN,KA5BD;AA6BAyB,gBACC;AAAAzB,YAAM,SAAN;AACAmB,oBAAc,IADd;AAEAO,cAAQ;AAFR,KA9BD;AAiCAC,kBACC;AAAA3B,YAAM,SAAN;AACAmB,oBAAc;AADd,KAlCD;AAoCAS,sBACC;AAAA5B,YAAM;AAAN,KArCD;AAsCA6B,oBACC;AAAA7B,YAAM;AAAN,KAvCD;AAwCA8B,kBACC;AAAA9B,YAAM;AAAN,KAzCD;AA0CA+B,kBACC;AAAA/B,YAAM;AAAN,KA3CD;AA4CAgC,yBACC;AAAAhC,YAAM,SAAN;AACAmB,oBAAc;AADd,KA7CD;AA+CAc,sBACC;AAAAjC,YAAM,SAAN;AACAmB,oBAAc;AADd,KAhDD;AAkDAe,aACC;AAAAlC,YAAM,SAAN;AACAmB,oBAAc,KADd;AAEAgB,YAAM;AAFN,KAnDD;AAsDAT,YACC;AAAA3B,aAAO,IAAP;AACAC,YAAM,SADN;AAEAmC,YAAM;AAFN,KAvDD;AA0DAC,iBACC;AAAArC,aAAO,aAAP;AACAC,YAAM,UADN;AAEAqC,eAAS;AAFT,KA3DD;AA8DAC,aACC;AAAAtC,YAAM,QAAN;AACAD,aAAO,MADP;AAEAwC,gBAAU,IAFV;AAGAJ,YAAM,IAHN;AAIAT,cAAQ;AAJR,KA/DD;AAoEAhC,YACC;AAAAM,YAAM,QAAN;AACAD,aAAO,IADP;AAEAwC,gBAAU,IAFV;AAGAJ,YAAM,IAHN;AAIAT,cAAQ;AAJR,KArED;AA0EAc,gBACC;AAAAxC,YAAM,QAAN;AACAD,aAAO,MADP;AAEAwC,gBAAU,IAFV;AAGAJ,YAAM,IAHN;AAIAT,cAAQ;AAJR,KA3ED;AAgFAe,aACC;AAAAzC,YAAM,QAAN;AACAD,aAAO,IADP;AAEAwC,gBAAU,IAFV;AAGAJ,YAAM,IAHN;AAIAT,cAAQ;AAJR,KAjFD;AAsFAgB,oBACC;AAAA1C,YAAM,QAAN;AACAD,aAAO,MADP;AAEAwC,gBAAU,IAFV;AAGAJ,YAAM,IAHN;AAIAT,cAAQ;AAJR,KAvFD;AA4FAiB,cACC;AAAA3C,YAAM,QAAN;AACAD,aAAO,KADP;AAEAwC,gBAAU,IAFV;AAGAJ,YAAM,IAHN;AAIAT,cAAQ;AAJR,KA7FD;AAkGAkB,YACC;AAAA7C,aAAO,IAAP;AACAC,YAAM,SADN;AAEAmC,YAAM;AAFN,KAnGD;AAsGAU,WACC;AAAA7C,YAAM,QAAN;AACA0B,cAAQ;AADR,KAvGD;AAyGAoB,mBACC;AAAA9C,YAAM,MAAN;AACA0B,cAAQ;AADR,KA1GD;AA4GAqB,iBACC;AAAA/C,YAAM,MAAN;AACA0B,cAAQ;AADR;AA7GD,GAJD;AAoHAc,cACC;AAAAQ,SACC;AAAAC,eAAS,CAAC,MAAD,EAAS,OAAT,EAAkB,WAAlB,EAA+B,UAA/B,CAAT;AACAlD,aAAM,IADN;AAEAmD,oBAAc;AAFd;AADD,GArHD;AA0HAR,kBACC;AAAAS,UACC;AAAAC,mBAAa,KAAb;AACAC,mBAAa,KADb;AAEAC,iBAAW,KAFX;AAGAC,iBAAW,KAHX;AAIAC,wBAAkB,KAJlB;AAKAC,sBAAgB;AALhB,KADD;AAOAC,WACC;AAAAN,mBAAa,IAAb;AACAC,mBAAa,IADb;AAEAC,iBAAW,IAFX;AAGAC,iBAAW,IAHX;AAIAC,wBAAkB,IAJlB;AAKAC,sBAAgB;AALhB;AARD,GA3HD;AA0IAhB,WACC;AAAAkB,gBACC;AAAA5D,aAAO,WAAP;AACA6D,eAAS,IADT;AAEAC,UAAI,QAFJ;AAGAC,YAAM,UAACC,WAAD,EAAcC,SAAd,EAAyBC,YAAzB;AACL,YAAAC,SAAA,EAAAC,MAAA,EAAAC,IAAA,EAAAC,MAAA;AAAAA,iBAASlF,QAAQmF,aAAR,CAAsBN,SAAtB,CAAT;;AAEA,aAAAK,UAAA,OAAGA,OAAQ5C,UAAX,GAAW,MAAX,KAAyB,IAAzB;AACC0C,mBAAAE,UAAA,OAASA,OAAQ5E,IAAjB,GAAiB,MAAjB;AACA2E,iBAAOG,aAAaC,YAAb,CAA0BC,QAAQC,GAAR,CAAY,SAAZ,CAA1B,EAAkDP,MAAlD,CAAP;AACAF,uBAAaU,IAAb,CAAkB,qBAAlB,EAAyCP,IAAzC;;AACA,cAAG,CAACH,aAAaU,IAAb,CAAkB,oBAAlB,CAAJ;AACCT,wBAAY,IAAIU,SAAJ,CAAcX,aAAa,CAAb,CAAd,CAAZ;AACAA,yBAAaU,IAAb,CAAkB,oBAAlB,EAAwC,IAAxC;AAEAT,sBAAUL,EAAV,CAAa,SAAb,EAAyB,UAACgB,CAAD;ACsDjB,qBDrDPC,OAAOC,OAAP,CAAe,MAAf,CCqDO;ADtDR;AAGAb,sBAAUL,EAAV,CAAa,OAAb,EAAuB,UAACgB,CAAD;AACtBC,qBAAOE,KAAP,CAAa,MAAb;ACsDO,qBDrDPC,QAAQD,KAAR,CAAc,GAAd,CCqDO;ADvDR;;AAKA,gBAAGf,aAAa,CAAb,EAAgBiB,OAAhB,KAA2B,IAA3B,IAAmCjB,aAAakB,QAAb,CAAsB,aAAtB,CAAtC;ACqDQ,qBDpDPlB,aAAamB,OAAb,CAAqB,OAArB,CCoDO;ADjET;AAJD;AAAA;ACyEM,iBDtDLN,OAAOE,KAAP,CAAa,cAAb,CCsDK;AACD;ADhFN;AAAA;AADD,GA3ID;AAwKArC,YACC;AAAA,oCACC;AAAAkB,UAAI,QAAJ;AACAwB,YAAM,eADN;AAEAvB,YAAM,UAACwB,MAAD,EAASrG,GAAT;AACL,YAAGD,eAAeC,GAAf,CAAH;AACCgG,kBAAQM,GAAR,CAAY,mBAAiBtG,IAAIQ,IAAjC;AACA,gBAAM,IAAI+F,OAAOC,KAAX,CAAiB,GAAjB,EAAsB,UAAtB,CAAN;ACyDI;;AACD,eDzDJxG,IAAI2D,MAAJ,GAAa,ICyDT;AD/DL;AAAA,KADD;AASA,oCACC;AAAAiB,UAAI,QAAJ;AACAwB,YAAM,eADN;AAEAvB,YAAM,UAACwB,MAAD,EAASrG,GAAT,EAAcyG,UAAd,EAA0BC,QAA1B,EAAoClF,OAApC;AACL,YAAAmF,GAAA;;AAAA,aAAAD,YAAA,QAAAC,MAAAD,SAAAE,IAAA,YAAAD,IAAmBnG,IAAnB,GAAmB,MAAnB,GAAmB,MAAnB,KAA2BR,IAAIQ,IAAJ,KAAYkG,SAASE,IAAT,CAAcpG,IAArD;AACCwF,kBAAQM,GAAR,CAAY,UAAZ;AACA,gBAAM,IAAIC,OAAOC,KAAX,CAAiB,GAAjB,EAAsB,SAAtB,CAAN;AC4DI;;AD3DL,YAAGE,SAASE,IAAZ;AACCF,mBAASE,IAAT,CAAcjD,MAAd,GAAuB,IAAvB;AC6DI;;AD3DL,YAAG+C,SAASG,MAAT,IAAmBH,SAASG,MAAT,CAAgBlD,MAAtC;AC6DM,iBD5DL,OAAO+C,SAASG,MAAT,CAAgBlD,MC4DlB;AACD;ADvEN;AAAA,KAVD;AAuBA,mCACC;AAAAiB,UAAI,QAAJ;AACAwB,YAAM,cADN;AAEAvB,YAAM,UAACwB,MAAD,EAASrG,GAAT;AAELE,gBAAQC,aAAR,CAAsB,eAAtB,EAAuC2G,MAAvC,CAA8C;AAACC,kBAAQ/G,IAAIQ,IAAb;AAAmBoD,iBAAOyC,MAA1B;AAAkC7F,gBAAM,MAAxC;AAAgDD,iBAAOP,IAAIO,KAA3D;AAAkEQ,gBAAM,MAAxE;AAAgFG,oBAAU,IAA1F;AAAgGD,iBAAO,IAAvG;AAA6GD,sBAAY;AAAzH,SAA9C;AACAd,gBAAQC,aAAR,CAAsB,kBAAtB,EAA0C2G,MAA1C,CAAiD;AAACtG,gBAAM,KAAP;AAAcD,iBAAOP,IAAIO,KAAzB;AAAgCqD,iBAAOyC,MAAvC;AAA+CvB,uBAAa9E,IAAIQ,IAAhE;AAAsEwG,kBAAQ,IAA9E;AAAoF/C,wBAAc,OAAlG;AAA2GD,mBAAS,CAAC,MAAD;AAApH,SAAjD;AC8EI,eD7EJ9D,QAAQC,aAAR,CAAsB,kBAAtB,EAA0C2G,MAA1C,CAAiD;AAACtG,gBAAM,QAAP;AAAiBD,iBAAOP,IAAIO,KAA5B;AAAmCqD,iBAAOyC,MAA1C;AAAkDvB,uBAAa9E,IAAIQ,IAAnE;AAAyEwG,kBAAQ,IAAjF;AAAuF/C,wBAAc,OAArG;AAA8GD,mBAAS,CAAC,MAAD;AAAvH,SAAjD,CC6EI;ADnFL;AAAA,KAxBD;AAgCA,oCACC;AAAAY,UAAI,QAAJ;AACAwB,YAAM,eADN;AAEAvB,YAAM,UAACwB,MAAD,EAASrG,GAAT;AAEL,YAAAiH,SAAA,EAAAC,kBAAA;;AAAA,YAAGlH,IAAI6D,aAAJ,IAAqB7D,IAAI8D,WAA5B;AACC;ACuFI;;ADrFLoD,6BAAqBhH,QAAQC,aAAR,CAAsBH,IAAIQ,IAA1B,EAAgCR,IAAIO,KAApC,CAArB;AAEA0G,oBAAYC,mBAAmB9G,IAAnB,CAAwB,EAAxB,EAA2B;AAACK,kBAAQ;AAACJ,iBAAK;AAAN;AAAT,SAA3B,CAAZ;;AAEA,YAAG4G,UAAUvG,KAAV,KAAoB,CAAvB;AACC,gBAAM,IAAI6F,OAAOC,KAAX,CAAiB,GAAjB,EAAsB,QAAMxG,IAAIQ,IAAV,GAAe,yBAArC,CAAN;ACyFI;ADrGN;AAAA,KAjCD;AA+CA,mCACC;AAAAoE,UAAI,QAAJ;AACAwB,YAAM,cADN;AAEAvB,YAAM,UAACwB,MAAD,EAASrG,GAAT;AAEL,YAAA4F,CAAA;AAAA1F,gBAAQC,aAAR,CAAsB,eAAtB,EAAuCgH,MAAvC,CAA8CC,MAA9C,CAAqD;AAACL,kBAAQ/G,IAAIQ,IAAb;AAAmBD,iBAAOP,IAAIO;AAA9B,SAArD;AAEAL,gBAAQC,aAAR,CAAsB,gBAAtB,EAAwCgH,MAAxC,CAA+CC,MAA/C,CAAsD;AAACL,kBAAQ/G,IAAIQ,IAAb;AAAmBD,iBAAOP,IAAIO;AAA9B,SAAtD;AAEAL,gBAAQC,aAAR,CAAsB,iBAAtB,EAAyCgH,MAAzC,CAAgDC,MAAhD,CAAuD;AAACL,kBAAQ/G,IAAIQ,IAAb;AAAmBD,iBAAOP,IAAIO;AAA9B,SAAvD;AAEAL,gBAAQC,aAAR,CAAsB,oBAAtB,EAA4CgH,MAA5C,CAAmDC,MAAnD,CAA0D;AAACtC,uBAAa9E,IAAIQ,IAAlB;AAAwBD,iBAAOP,IAAIO;AAAnC,SAA1D;AAEAL,gBAAQC,aAAR,CAAsB,kBAAtB,EAA0CgH,MAA1C,CAAiDC,MAAjD,CAAwD;AAACtC,uBAAa9E,IAAIQ,IAAlB;AAAwBD,iBAAOP,IAAIO;AAAnC,SAAxD;AAGAyF,gBAAQM,GAAR,CAAY,iBAAZ,EAA+BtG,IAAIQ,IAAnC;;AACA;ACoGM,iBDlGLN,QAAQmH,WAAR,CAAoB,OAAKrH,IAAIO,KAAT,GAAe,GAAf,GAAkBP,IAAIQ,IAA1C,EAAkD8G,WAAlD,CAA8DC,cAA9D,ECkGK;ADpGN,iBAAAxB,KAAA;AAGMH,cAAAG,KAAA;AACLC,kBAAQD,KAAR,CAAc,OAAK/F,IAAIO,KAAT,GAAe,GAAf,GAAkBP,IAAIQ,IAApC,EAA4C,KAAGoF,EAAE4B,KAAjD;AACA,gBAAM,IAAIjB,OAAOC,KAAX,CAAiB,GAAjB,EAAsB,QAAMxG,IAAIQ,IAAV,GAAe,WAArC,CAAN;ACoGI;ADzHN;AAAA;AAhDD;AAzKD,CADD,C;;;;;;;;;;;;;;;;;;;AEPA,IAAAiH,aAAA,EAAA1H,cAAA;;AAAA0H,gBAAgB,UAACzH,GAAD;AACf,MAAAS,MAAA,EAAAiH,aAAA,EAAAC,YAAA;AAAAD,kBAAgBxH,QAAQC,aAAR,CAAsB,eAAtB,EAAuCC,IAAvC,CAA4C;AAACG,WAAOP,IAAIO,KAAZ;AAAmBwG,YAAQ/G,IAAI+G;AAA/B,GAA5C,EAAoF;AACnGtG,YAAQ;AACPmH,eAAS,CADF;AAEPC,gBAAU,CAFH;AAGPjE,aAAO,CAHA;AAIPkE,kBAAY,CAJL;AAKPC,mBAAa;AALN;AAD2F,GAApF,EAQbC,KARa,EAAhB;AAUAvH,WAAS,EAAT;AAEAkH,iBAAe,EAAf;;AAEAlG,IAAEC,OAAF,CAAUgG,aAAV,EAAyB,UAACO,CAAD;AACxB,QAAAC,MAAA,EAAAC,YAAA;;AAAA,QAAG,2CAA2CC,IAA3C,CAAgDH,EAAEzH,IAAlD,CAAH;AACC0H,eAASD,EAAEzH,IAAF,CAAO6H,KAAP,CAAa,KAAb,CAAT;AACAF,qBAAe,EAAf;AACAA,mBAAaD,OAAO,CAAP,CAAb,IAA0BD,CAA1B;;AACA,UAAG,CAACxG,EAAE6G,IAAF,CAAOX,aAAaO,OAAO,CAAP,CAAb,CAAP,CAAJ;AACCP,qBAAaO,OAAO,CAAP,CAAb,IAA0B,EAA1B;ACKG;;AACD,aDLHzG,EAAE8G,MAAF,CAASZ,aAAaO,OAAO,CAAP,CAAb,CAAT,EAAkCC,YAAlC,CCKG;ADXJ;ACaI,aDLH1H,OAAOwH,EAAEzH,IAAT,IAAiByH,CCKd;AACD;ADfJ;;AAWAxG,IAAE+G,IAAF,CAAOb,YAAP,EAAqB,UAACM,CAAD,EAAIQ,CAAJ;AACpB,QAAGhI,OAAOgI,CAAP,EAAU1H,IAAV,KAAkB,MAArB;AACC,UAAG,CAACU,EAAE6G,IAAF,CAAO7H,OAAOgI,CAAP,EAAUhI,MAAjB,CAAJ;AACCA,eAAOgI,CAAP,EAAUhI,MAAV,GAAmB,EAAnB;ACOG;;AACD,aDPHgB,EAAE8G,MAAF,CAAS9H,OAAOgI,CAAP,EAAUhI,MAAnB,EAA2BwH,CAA3B,CCOG;AACD;ADZJ;;ACcC,SDRD/H,QAAQC,aAAR,CAAsB,SAAtB,EAAiCuI,MAAjC,CAAwC;AAACnI,WAAOP,IAAIO,KAAZ;AAAmBC,UAAMR,IAAI+G;AAA7B,GAAxC,EAA8E;AAC7EH,UACC;AAAAnG,cAAQA;AAAR;AAF4E,GAA9E,CCQC;ADxCc,CAAhB;;AAqCAV,iBAAiB,UAACC,GAAD,EAAMQ,IAAN;AAChB,MAAAP,KAAA;AAAAA,UAAQC,QAAQC,aAAR,CAAsB,eAAtB,EAAuCC,IAAvC,CAA4C;AAAC2G,YAAQ/G,IAAI+G,MAAb;AAAsBxG,WAAOP,IAAIO,KAAjC;AAAwCF,SAAK;AAACC,WAAKN,IAAIK;AAAV,KAA7C;AAA6DG,UAAMA,QAAQR,IAAIQ;AAA/E,GAA5C,EAAkI;AAACC,YAAO;AAACJ,WAAK;AAAN;AAAR,GAAlI,CAAR;;AACA,MAAGJ,MAAMS,KAAN,KAAgB,CAAnB;AACC,WAAO,IAAP;AC0BC;;ADzBF,SAAO,KAAP;AAJgB,CAAjB;;AAMAR,QAAQS,OAAR,CAAgB+G,aAAhB,GACC;AAAAlH,QAAM,eAAN;AACAK,QAAM,QADN;AAEA2B,cAAY,IAFZ;AAGA1B,SAAM,IAHN;AAIAL,UACC;AAAAD,UACC;AAAAO,YAAM,MAAN;AACAC,kBAAY,IADZ;AAEAC,aAAO,IAFP;AAGAC,gBAAU,IAHV;AAIAC,aAAOC,aAAaC,KAAb,CAAmBsH;AAJ1B,KADD;AAMA7H,WACC;AAAAC,YAAM;AAAN,KAPD;AAQA6H,aACC;AAAA7H,YAAM,SAAN;AACA0B,cAAQ;AADR,KATD;AAWAsE,YACC;AAAAhG,YAAM,eAAN;AACA8H,oBAAc,SADd;AAEA3H,gBAAU,IAFV;AAGAK,uBAAiB;AAChB,YAAAuH,QAAA;;AAAAA,mBAAW,EAAX;;AACArH,UAAEC,OAAF,CAAUxB,QAAQ6I,aAAlB,EAAiC,UAACC,CAAD,EAAIP,CAAJ;ACgC3B,iBD/BLK,SAAS/G,IAAT,CAAc;AAACjB,mBAAOkI,EAAElI,KAAV;AAAiBkB,mBAAOyG,CAAxB;AAA2B5H,kBAAMmI,EAAEnI;AAAnC,WAAd,CC+BK;ADhCN;;AAEA,eAAOiI,QAAP;AAPD;AAAA,KAZD;AAoBA/H,UACC;AAAAA,YAAM,QAAN;AAEAS,eACC;AAAAyH,cAAM,IAAN;AACAC,kBAAU,KADV;AAEAC,cAAM,QAFN;AAGAC,gBAAQ,KAHR;AAIAC,iBAAS,UAJT;AAKAC,cAAM,IALN;AAMAC,kBAAU,MANV;AAOAC,gBAAQ,IAPR;AAQAC,kBAAU,IARV;AASAC,kBAAU,IATV;AAUAC,gBAAQ,KAVR;AAWAC,uBAAe,OAXf;AAYAC,cAAM,IAZN;AAaAC,aAAK,IAbL;AAcAC,eAAO;AAdP;AAHD,KArBD;AAuCAC,aACC;AAAAlJ,aAAO,KAAP;AACAC,YAAM,QADN;AAEAmB,oBAAc,GAFd;AAGA+H,aAAO,CAHP;AAIAC,gBAAU;AAJV,KAxCD;AA8CAC,WACC;AAAApJ,YAAM;AAAN,KA/CD;AAiDAmB,kBACC;AAAAnB,YAAM;AAAN,KAlDD;AAoDAqJ,mBACC;AAAArJ,YAAM,MAAN;AACAsJ,gBAAU;AADV,KArDD;AAwDAA,cACC;AAAAtJ,YAAM;AAAN,KAzDD;AA2DAG,cACC;AAAAH,YAAM;AAAN,KA5DD;AA8DAqC,aACC;AAAArC,YAAM;AAAN,KA/DD;AAiEAuJ,cACC;AAAAvJ,YAAM;AAAN,KAlED;AAsEA0B,YACC;AAAA1B,YAAM;AAAN,KAvED;AAyEAmC,UACC;AAAAnC,YAAM;AAAN,KA1ED;AA4EAE,WACC;AAAAF,YAAM;AAAN,KA7ED;AA+EAC,gBACC;AAAAD,YAAM;AAAN,KAhFD;AAkFAmJ,cACC;AAAAnJ,YAAM;AAAN,KAnFD;AAqFAwJ,eACC;AAAAxJ,YAAM,UAAN;AACAmB,oBAAc;AADd,KAtFD;AAyFA+H,WACC;AAAAlJ,YAAM,UAAN;AACAmB,oBAAc;AADd,KA1FD;AA6FA2G,kBACC;AAAA9H,YAAM,QAAN;AACAQ,uBAAiB;AAChB,YAAAuH,QAAA;;AAAAA,mBAAW,EAAX;;AACArH,UAAEC,OAAF,CAAUxB,QAAQS,OAAlB,EAA2B,UAACqI,CAAD,EAAIP,CAAJ;ACuCrB,iBDtCLK,SAAS/G,IAAT,CAAc;AAACjB,mBAAOkI,EAAElI,KAAV;AAAiBkB,mBAAOyG,CAAxB;AAA2B5H,kBAAMmI,EAAEnI;AAAnC,WAAd,CCsCK;ADvCN;;AAEA,eAAOiI,QAAP;AALD;AAAA,KA9FD;AAsGA0B,UACC;AAAAzJ,YAAM;AAAN,KAvGD;AAyGAS,aACC;AAAAT,YAAM,UAAN;AACAqC,eAAS;AADT,KA1GD;AA6GAD,iBACC;AAAArC,aAAO,aAAP;AACAC,YAAM,MADN;AAEAqC,eAAS;AAFT;AA9GD,GALD;AAuHAG,cACC;AAAAQ,SACC;AAAAC,eAAS,CAAC,MAAD,EAAS,OAAT,EAAkB,MAAlB,EAA0B,QAA1B,EAAoC,SAApC,EAA+C,UAA/C,CAAT;AACAyG,YAAM,CAAC;AAACC,oBAAY,SAAb;AAAwBC,eAAO;AAA/B,OAAD,CADN;AAEA1G,oBAAc;AAFd;AADD,GAxHD;AA6HAR,kBACC;AAAAS,UACC;AAAAC,mBAAa,KAAb;AACAC,mBAAa,KADb;AAEAC,iBAAW,KAFX;AAGAC,iBAAW,KAHX;AAIAC,wBAAkB,KAJlB;AAKAC,sBAAgB;AALhB,KADD;AAOAC,WACC;AAAAN,mBAAa,IAAb;AACAC,mBAAa,IADb;AAEAC,iBAAW,IAFX;AAGAC,iBAAW,IAHX;AAIAC,wBAAkB,IAJlB;AAKAC,sBAAgB;AALhB;AARD,GA9HD;AA6IAd,YACC;AAAA,yCACC;AAAAkB,UAAI,QAAJ;AACAwB,YAAM,cADN;AAEAvB,YAAM,UAACwB,MAAD,EAASrG,GAAT;ACqDD,eDpDJyH,cAAczH,GAAd,CCoDI;ADvDL;AAAA,KADD;AAKA,yCACC;AAAA4E,UAAI,QAAJ;AACAwB,YAAM,cADN;AAEAvB,YAAM,UAACwB,MAAD,EAASrG,GAAT;ACuDD,eDtDJyH,cAAczH,GAAd,CCsDI;ADzDL;AAAA,KAND;AAUA,yCACC;AAAA4E,UAAI,QAAJ;AACAwB,YAAM,cADN;AAEAvB,YAAM,UAACwB,MAAD,EAASrG,GAAT;ACyDD,eDxDJyH,cAAczH,GAAd,CCwDI;AD3DL;AAAA,KAXD;AAeA,0CACC;AAAA4E,UAAI,QAAJ;AACAwB,YAAM,eADN;AAEAvB,YAAM,UAACwB,MAAD,EAASrG,GAAT,EAAcyG,UAAd,EAA0BC,QAA1B,EAAoClF,OAApC;AACL,YAAAoJ,aAAA,EAAA7D,MAAA,EAAA8D,gBAAA,EAAAlE,GAAA,EAAAmE,IAAA,EAAAC,IAAA,EAAAC,IAAA,EAAAC,IAAA,EAAAC,IAAA,EAAAC,IAAA,EAAAC,IAAA;;AAAA,YAAGpL,IAAIQ,IAAJ,KAAY,MAAZ,KAAAkG,YAAA,QAAAC,MAAAD,SAAAE,IAAA,YAAAD,IAAsCnG,IAAtC,GAAsC,MAAtC,GAAsC,MAAtC,KAA8CR,IAAIQ,IAAJ,KAAYkG,SAASE,IAAT,CAAcpG,IAA3E;AACC,gBAAM,IAAI+F,OAAOC,KAAX,CAAiB,GAAjB,EAAsB,gBAAtB,CAAN;AC4DI;;AD3DL,aAAAE,YAAA,QAAAoE,OAAApE,SAAAE,IAAA,YAAAkE,KAAmBtK,IAAnB,GAAmB,MAAnB,GAAmB,MAAnB,KAA2BT,eAAeC,GAAf,EAAoB0G,SAASE,IAAT,CAAcpG,IAAlC,CAA3B;AACCwF,kBAAQM,GAAR,CAAY,0BAAwBtG,IAAIQ,IAAxC;AACA,gBAAM,IAAI+F,OAAOC,KAAX,CAAiB,GAAjB,EAAsB,UAAtB,CAAN;AC6DI;;AD3DL,YAAAE,YAAA,QAAAqE,OAAArE,SAAAE,IAAA,YAAAmE,KAAmBlC,YAAnB,GAAmB,MAAnB,GAAmB,MAAnB;AACC,cAAGnC,SAASE,IAAT,CAAciC,YAAd,CAA2BwC,MAA3B,KAAqC,CAAxC;AACCT,4BAAgBlE,SAASE,IAAT,CAAciC,YAAd,CAA2B,CAA3B,CAAhB;AADD;AAGC+B,4BAAgBlE,SAASE,IAAT,CAAciC,YAA9B;AAJF;ACkEK;;AD7DL,aAAAnC,YAAA,QAAAsE,OAAAtE,SAAAE,IAAA,YAAAoE,KAAmB/J,KAAnB,GAAmB,MAAnB,GAAmB,MAAnB,MAA6B,CAAAyF,YAAA,QAAAuE,OAAAvE,SAAAE,IAAA,YAAAqE,KAAiBlK,IAAjB,GAAiB,MAAjB,GAAiB,MAAjB,MAAyB,UAAzB,IAAC,CAAA2F,YAAA,QAAAwE,OAAAxE,SAAAE,IAAA,YAAAsE,KAAsDnK,IAAtD,GAAsD,MAAtD,GAAsD,MAAtD,MAA8D,MAA5F;AACC,gBAAM,IAAIwF,OAAOC,KAAX,CAAiB,GAAjB,EAAsB,aAAtB,CAAN;AC+DI;;AD9DLO,iBAAS7G,QAAQC,aAAR,CAAsB,SAAtB,EAAiCmL,OAAjC,CAAyC;AAACjL,eAAKL,IAAI+G;AAAV,SAAzC,EAA4D;AAACtG,kBAAQ;AAACD,kBAAM,CAAP;AAAUM,mBAAO;AAAjB;AAAT,SAA5D,CAAT;;AAEA,YAAGiG,MAAH;AAEC8D,6BAAmB3K,QAAQC,aAAR,CAAsB4G,OAAOvG,IAA7B,EAAmCJ,IAAnC,EAAnB;;AACA,eAAAsG,YAAA,QAAAyE,OAAAzE,SAAAE,IAAA,YAAAuE,KAAmBtC,YAAnB,GAAmB,MAAnB,GAAmB,MAAnB,KAAmC7I,IAAI6I,YAAJ,KAAoB+B,aAAvD,IAAwEC,iBAAiBnK,KAAjB,KAA2B,CAAnG;AACC,kBAAM,IAAI6F,OAAOC,KAAX,CAAiB,GAAjB,EAAsB,OAAKO,OAAOjG,KAAZ,GAAkB,2BAAxC,CAAN;ACqEK;;ADnEN,eAAA4F,YAAA,QAAA0E,OAAA1E,SAAAG,MAAA,YAAAuE,KAAqBvC,YAArB,GAAqB,MAArB,GAAqB,MAArB,KAAqC7I,IAAI6I,YAAJ,KAAoB+B,aAAzD,IAA0EC,iBAAiBnK,KAAjB,KAA2B,CAArG;AACC,kBAAM,IAAI6F,OAAOC,KAAX,CAAiB,GAAjB,EAAsB,OAAKO,OAAOjG,KAAZ,GAAkB,2BAAxC,CAAN;AAPF;AC6EK;AD/FN;AAAA,KAhBD;AA8CA,0CACC;AAAA8D,UAAI,QAAJ;AACAwB,YAAM,eADN;AAEAvB,YAAM,UAACwB,MAAD,EAASrG,GAAT;AAKL,YAAGD,eAAeC,GAAf,CAAH;AACCgG,kBAAQM,GAAR,CAAY,0BAAwBtG,IAAIQ,IAAxC;AACA,gBAAM,IAAI+F,OAAOC,KAAX,CAAiB,GAAjB,EAAsB,UAAtB,CAAN;ACiEI;;ADhEL,aAAAxG,OAAA,OAAGA,IAAKiB,KAAR,GAAQ,MAAR,MAAkB,CAAAjB,OAAA,OAACA,IAAKe,IAAN,GAAM,MAAN,MAAc,UAAd,IAAC,CAAAf,OAAA,OAA2BA,IAAKe,IAAhC,GAAgC,MAAhC,MAAwC,MAA3D;AACC,gBAAM,IAAIwF,OAAOC,KAAX,CAAiB,GAAjB,EAAqB,aAArB,CAAN;ACkEI;AD7EN;AAAA,KA/CD;AA2DA,0CACC;AAAA5B,UAAI,QAAJ;AACAwB,YAAM,eADN;AAEAvB,YAAM,UAACwB,MAAD,EAASrG,GAAT;AACL,YAAGA,IAAIQ,IAAJ,KAAY,MAAf;AACC,gBAAM,IAAI+F,OAAOC,KAAX,CAAiB,GAAjB,EAAsB,SAAtB,CAAN;ACqEI;ADzEN;AAAA;AA5DD;AA9ID,CADD,C;;;;;;;;;;;;;;;;;;;AE3CA,IAAAiB,aAAA,EAAA8D,KAAA,EAAAxL,cAAA;;AAAA0H,gBAAgB,UAACzH,GAAD;AACf,MAAAwL,eAAA,EAAA9H,QAAA;AAAA8H,oBAAkBtL,QAAQC,aAAR,CAAsB,iBAAtB,EAAyCC,IAAzC,CAA8C;AAACG,WAAOP,IAAIO,KAAZ;AAAmBwG,YAAQ/G,IAAI+G,MAA/B;AAAuC9E,eAAW;AAAlD,GAA9C,EAAuG;AACxHxB,YAAQ;AACPmH,eAAS,CADF;AAEPC,gBAAU,CAFH;AAGPjE,aAAO,CAHA;AAIPkE,kBAAY,CAJL;AAKPC,mBAAa;AALN;AADgH,GAAvG,EAQfC,KARe,EAAlB;AAUAtE,aAAW,EAAX;;AAEAjC,IAAEC,OAAF,CAAU8J,eAAV,EAA2B,UAACvD,CAAD;ACMxB,WDLFvE,SAASuE,EAAEzH,IAAX,IAAmByH,CCKjB;ADNH;;ACQC,SDLD/H,QAAQC,aAAR,CAAsB,SAAtB,EAAiCuI,MAAjC,CAAwC;AAACnI,WAAOP,IAAIO,KAAZ;AAAmBC,UAAMR,IAAI+G;AAA7B,GAAxC,EAA8E;AAC7EH,UACC;AAAAlD,gBAAUA;AAAV;AAF4E,GAA9E,CCKC;ADrBc,CAAhB;;AAqBA3D,iBAAiB,UAACC,GAAD,EAAMQ,IAAN;AAChB,MAAAP,KAAA;AAAAA,UAAQC,QAAQC,aAAR,CAAsB,iBAAtB,EAAyCC,IAAzC,CAA8C;AAAC2G,YAAQ/G,IAAI+G,MAAb;AAAsBxG,WAAOP,IAAIO,KAAjC;AAAwCF,SAAK;AAACC,WAAKN,IAAIK;AAAV,KAA7C;AAA6DG,UAAMA,QAAQR,IAAIQ;AAA/E,GAA9C,EAAoI;AAACC,YAAO;AAACJ,WAAK;AAAN;AAAR,GAApI,CAAR;;AACA,MAAGJ,MAAMS,KAAN,KAAgB,CAAnB;AACC,WAAO,IAAP;ACuBC;;ADtBF,SAAO,KAAP;AAJgB,CAAjB;;AAMA6K,QAAQ,UAAClF,MAAD,EAASrG,GAAT;AACP,MAAGyL,QAAQC,YAAR,CAAqBrF,MAArB,EAA6BrG,IAAIO,KAAjC,CAAH;AACC,UAAM,IAAIgG,OAAOC,KAAX,CAAiB,GAAjB,EAAsB,iBAAtB,CAAN;ACyBC;;ADtBF,MAAGxG,IAAI4E,EAAJ,KAAU,QAAV,IAAsB,CAAC6G,QAAQE,cAAR,CAAuB3L,IAAIO,KAA3B,EAAiC,qBAAjC,CAA1B;AACC,UAAM,IAAIgG,OAAOC,KAAX,CAAiB,GAAjB,EAAsB,kBAAtB,CAAN;ACwBC;AD9BK,CAAR;;AAQAtG,QAAQS,OAAR,CAAgB6K,eAAhB,GACC;AAAAhL,QAAM,iBAAN;AACAK,QAAM,oBADN;AAEAC,SAAM,KAFN;AAGAL,UACC;AAAAD,UACC;AAAAO,YAAM,MAAN;AACAC,kBAAY,IADZ;AAEAC,aAAO,IAFP;AAGAC,gBAAU,IAHV;AAIAC,aAAOC,aAAaC,KAAb,CAAmBC;AAJ1B,KADD;AAMAR,WACC;AAAAC,YAAM;AAAN,KAPD;AAQAgG,YACC;AAAAhG,YAAM,eAAN;AACA8H,oBAAc,SADd;AAEA3H,gBAAU,IAFV;AAGAK,uBAAiB;AAChB,YAAAuH,QAAA;;AAAAA,mBAAW,EAAX;;AACArH,UAAEC,OAAF,CAAUxB,QAAQ6I,aAAlB,EAAiC,UAACC,CAAD,EAAIP,CAAJ;AC6B3B,iBD5BLK,SAAS/G,IAAT,CAAc;AAACjB,mBAAOkI,EAAElI,KAAV;AAAiBkB,mBAAOyG,CAAxB;AAA2B5H,kBAAMmI,EAAEnI;AAAnC,WAAd,CC4BK;AD7BN;;AAEA,eAAOiI,QAAP;AAPD;AAAA,KATD;AAiBAlE,QACC;AAAA7D,YAAM,QAAN;AACAG,gBAAU,IADV;AAEAK,uBAAiB;AAChB,eAAO,CAAC;AAACT,iBAAO,KAAR;AAAekB,iBAAO,QAAtB;AAAgCnB,gBAAM;AAAtC,SAAD,EAAmD;AAACC,iBAAO,KAAR;AAAekB,iBAAO,QAAtB;AAAgCnB,gBAAM;AAAtC,SAAnD,CAAP;AAHD;AAAA,KAlBD;AAsBAuF,UACC;AAAArF,YAAM,QAAN;AACAG,gBAAU,IADV;AAEAK,uBAAiB;ACgDZ,eD/CJ,CACC;AAACT,iBAAO,QAAR;AAAkBkB,iBAAO,eAAzB;AAA0CnB,gBAAM;AAAhD,SADD,EAEC;AAACC,iBAAO,QAAR;AAAkBkB,iBAAO,cAAzB;AAAyCnB,gBAAM;AAA/C,SAFD,EAGC;AAACC,iBAAO,QAAR;AAAkBkB,iBAAO,eAAzB;AAA0CnB,gBAAM;AAAhD,SAHD,EAIC;AAACC,iBAAO,QAAR;AAAkBkB,iBAAO,cAAzB;AAAyCnB,gBAAM;AAA/C,SAJD,EAKC;AAACC,iBAAO,QAAR;AAAkBkB,iBAAO,eAAzB;AAA0CnB,gBAAM;AAAhD,SALD,EAMC;AAACC,iBAAO,QAAR;AAAkBkB,iBAAO,cAAzB;AAAyCnB,gBAAM;AAA/C,SAND,CC+CI;ADlDL;AAAA,KAvBD;AAkCAoB,eACC;AAAAlB,YAAM;AAAN,KAnCD;AAoCA8D,UACC;AAAA9D,YAAM,UAAN;AACAG,gBAAU,IADV;AAEAkC,eAAQ;AAFR;AArCD,GAJD;AA6CAG,cACC;AAAAQ,SACC;AAAAC,eAAS,CAAC,MAAD,EAAS,OAAT,EAAkB,QAAlB,EAA4B,IAA5B,EAAkC,MAAlC,EAA0C,WAA1C,CAAT;AACAC,oBAAc;AADd;AADD,GA9CD;AAkDAR,kBACC;AAAAS,UACC;AAAAC,mBAAa,KAAb;AACAC,mBAAa,KADb;AAEAC,iBAAW,KAFX;AAGAC,iBAAW,KAHX;AAIAC,wBAAkB,KAJlB;AAKAC,sBAAgB;AALhB,KADD;AAOAC,WACC;AAAAN,mBAAa,IAAb;AACAC,mBAAa,IADb;AAEAC,iBAAW,IAFX;AAGAC,iBAAW,IAHX;AAIAC,wBAAkB,IAJlB;AAKAC,sBAAgB;AALhB;AARD,GAnDD;AAkEAd,YACC;AAAA,2CACC;AAAAkB,UAAI,QAAJ;AACAwB,YAAM,cADN;AAEAvB,YAAM,UAACwB,MAAD,EAASrG,GAAT;AC0ED,eDzEJyH,cAAczH,GAAd,CCyEI;AD5EL;AAAA,KADD;AAKA,2CACC;AAAA4E,UAAI,QAAJ;AACAwB,YAAM,cADN;AAEAvB,YAAM,UAACwB,MAAD,EAASrG,GAAT;AC4ED,eD3EJyH,cAAczH,GAAd,CC2EI;AD9EL;AAAA,KAND;AAUA,2CACC;AAAA4E,UAAI,QAAJ;AACAwB,YAAM,cADN;AAEAvB,YAAM,UAACwB,MAAD,EAASrG,GAAT;AC8ED,eD7EJyH,cAAczH,GAAd,CC6EI;ADhFL;AAAA,KAXD;AAgBA,4CACC;AAAA4E,UAAI,QAAJ;AACAwB,YAAM,eADN;AAEAvB,YAAM,UAACwB,MAAD,EAASrG,GAAT;AC+ED,eD9EJuL,MAAMlF,MAAN,EAAcrG,GAAd,CC8EI;ADjFL;AAAA,KAjBD;AAsBA,4CACC;AAAA4E,UAAI,QAAJ;AACAwB,YAAM,eADN;AAEAvB,YAAM,UAACwB,MAAD,EAASrG,GAAT,EAAcyG,UAAd,EAA0BC,QAA1B,EAAoClF,OAApC;AACL,YAAAmF,GAAA;AAAA4E,cAAMlF,MAAN,EAAcrG,GAAd;;AACA,aAAA0G,YAAA,QAAAC,MAAAD,SAAAE,IAAA,YAAAD,IAAmBnG,IAAnB,GAAmB,MAAnB,GAAmB,MAAnB,KAA2BT,eAAeC,GAAf,EAAoB0G,SAASE,IAAT,CAAcpG,IAAlC,CAA3B;AACCwF,kBAAQM,GAAR,CAAY,4BAA0BtG,IAAIQ,IAA1C;AACA,gBAAM,IAAI+F,OAAOC,KAAX,CAAiB,GAAjB,EAAsB,aAAWxG,IAAIQ,IAArC,CAAN;ACiFI;ADvFN;AAAA,KAvBD;AA+BA,4CACC;AAAAoE,UAAI,QAAJ;AACAwB,YAAM,eADN;AAEAvB,YAAM,UAACwB,MAAD,EAASrG,GAAT;AACLuL,cAAMlF,MAAN,EAAcrG,GAAd;;AACA,YAAGD,eAAeC,GAAf,CAAH;AACCgG,kBAAQM,GAAR,CAAY,4BAA0BtG,IAAIQ,IAA1C;AACA,gBAAM,IAAI+F,OAAOC,KAAX,CAAiB,GAAjB,EAAsB,UAAtB,CAAN;ACmFI;ADzFN;AAAA;AAhCD;AAnED,CADD,C;;;;;;;;;;;;;;;;;;;AEnCA,IAAAiB,aAAA,EAAA1H,cAAA;;AAAA0H,gBAAgB,UAACzH,GAAD;AACf,MAAAwD,OAAA,EAAAoI,cAAA;AAAAA,mBAAiB1L,QAAQC,aAAR,CAAsB,gBAAtB,EAAwCC,IAAxC,CAA6C;AAAC2G,YAAQ/G,IAAI+G,MAAb;AAAqBxG,WAAOP,IAAIO,KAAhC;AAAuC0B,eAAW;AAAlD,GAA7C,EAAsG;AACtHxB,YAAQ;AACPmH,eAAS,CADF;AAEPC,gBAAU,CAFH;AAGPjE,aAAO,CAHA;AAIPkE,kBAAY,CAJL;AAKPC,mBAAa;AALN;AAD8G,GAAtG,EAQdC,KARc,EAAjB;AAUAxE,YAAU,EAAV;;AAEA/B,IAAEC,OAAF,CAAUkK,cAAV,EAA0B,UAAC3D,CAAD;ACMvB,WDLFzE,QAAQyE,EAAEzH,IAAV,IAAkByH,CCKhB;ADNH;;ACQC,SDLD/H,QAAQC,aAAR,CAAsB,SAAtB,EAAiCuI,MAAjC,CAAwC;AAACnI,WAAOP,IAAIO,KAAZ;AAAmBC,UAAMR,IAAI+G;AAA7B,GAAxC,EAA8E;AAC7EH,UACC;AAAApD,eAASA;AAAT;AAF4E,GAA9E,CCKC;ADrBc,CAAhB;;AAoBAzD,iBAAiB,UAACC,GAAD,EAAMQ,IAAN;AAChB,MAAAP,KAAA;AAAAA,UAAQC,QAAQC,aAAR,CAAsB,gBAAtB,EAAwCC,IAAxC,CAA6C;AAAC2G,YAAQ/G,IAAI+G,MAAb;AAAsBxG,WAAOP,IAAIO,KAAjC;AAAwCF,SAAK;AAACC,WAAKN,IAAIK;AAAV,KAA7C;AAA6DG,UAAMA,QAAQR,IAAIQ;AAA/E,GAA7C,EAAmI;AAACC,YAAO;AAACJ,WAAK;AAAN;AAAR,GAAnI,CAAR;;AACA,MAAGJ,MAAMS,KAAN,KAAgB,CAAnB;AACC,WAAO,IAAP;ACwBC;;ADvBF,SAAO,KAAP;AAJgB,CAAjB;;AAKAR,QAAQS,OAAR,CAAgBiL,cAAhB,GACC;AAAApL,QAAM,gBAAN;AACAM,SAAO,MADP;AAEAD,QAAM,mBAFN;AAGAJ,UACC;AAAAsG,YACC;AAAAhG,YAAM,eAAN;AACA8H,oBAAc,SADd;AAEA3H,gBAAU,IAFV;AAGAK,uBAAiB;AAChB,YAAAuH,QAAA;;AAAAA,mBAAW,EAAX;;AACArH,UAAEC,OAAF,CAAUxB,QAAQ6I,aAAlB,EAAiC,UAACC,CAAD,EAAIP,CAAJ;AC4B3B,iBD3BLK,SAAS/G,IAAT,CAAc;AAACjB,mBAAOkI,EAAElI,KAAV;AAAiBkB,mBAAOyG,CAAxB;AAA2B5H,kBAAMmI,EAAEnI;AAAnC,WAAd,CC2BK;AD5BN;;AAEA,eAAOiI,QAAP;AAPD;AAAA,KADD;AASAtI,UACC;AAAAO,YAAM,MAAN;AACAC,kBAAW,IADX;AAEAC,aAAM,IAFN;AAGAC,gBAAU,IAHV;AAIAC,aAAOC,aAAaC,KAAb,CAAmBC;AAJ1B,KAVD;AAeAR,WACC;AAAAC,YAAM;AAAN,KAhBD;AAiBAkB,eACC;AAAAlB,YAAM;AAAN,KAlBD;AAmBA4D,aACC;AAAA5D,YAAM,SAAN;AACAmC,YAAM;AADN,KApBD;AAsBA0B,QACC;AAAA7D,YAAM,QAAN;AACAqC,eAAQ,IADR;AAEAlC,gBAAU,IAFV;AAGAK,uBAAiB;ACuCZ,eDtCJ,CACC;AAACT,iBAAO,UAAR;AAAoBkB,iBAAO,MAA3B;AAAmCnB,gBAAM;AAAzC,SADD,EAEC;AAACC,iBAAO,aAAR;AAAuBkB,iBAAO,QAA9B;AAAwCnB,gBAAM;AAA9C,SAFD,CCsCI;AD1CL;AAAA,KAvBD;AA+BAgE,UACC;AAAA/D,aAAO,OAAP;AACAC,YAAM,UADN;AAEAG,gBAAU,IAFV;AAGAkC,eAAQ;AAHR;AAhCD,GAJD;AA0CAG,cACC;AAAAQ,SACC;AAAAC,eAAS,CAAC,MAAD,EAAS,OAAT,EAAkB,QAAlB,EAA4B,IAA5B,EAAkC,WAAlC,EAA+C,UAA/C,CAAT;AACAC,oBAAc;AADd;AADD,GA3CD;AA+CAR,kBACC;AAAAS,UACC;AAAAC,mBAAa,KAAb;AACAC,mBAAa,KADb;AAEAC,iBAAW,KAFX;AAGAC,iBAAW,KAHX;AAIAC,wBAAkB,KAJlB;AAKAC,sBAAgB;AALhB,KADD;AAOAC,WACC;AAAAN,mBAAa,IAAb;AACAC,mBAAa,IADb;AAEAC,iBAAW,IAFX;AAGAC,iBAAW,IAHX;AAIAC,wBAAkB,IAJlB;AAKAC,sBAAgB;AALhB;AARD,GAhDD;AA+DAd,YACC;AAAA,0CACC;AAAAkB,UAAI,QAAJ;AACAwB,YAAM,cADN;AAEAvB,YAAM,UAACwB,MAAD,EAASrG,GAAT;ACmDD,eDlDJyH,cAAczH,GAAd,CCkDI;ADrDL;AAAA,KADD;AAKA,0CACC;AAAA4E,UAAI,QAAJ;AACAwB,YAAM,cADN;AAEAvB,YAAM,UAACwB,MAAD,EAASrG,GAAT;ACqDD,eDpDJyH,cAAczH,GAAd,CCoDI;ADvDL;AAAA,KAND;AAUA,0CACC;AAAA4E,UAAI,QAAJ;AACAwB,YAAM,cADN;AAEAvB,YAAM,UAACwB,MAAD,EAASrG,GAAT;ACuDD,eDtDJyH,cAAczH,GAAd,CCsDI;ADzDL;AAAA,KAXD;AAgBA,2CACC;AAAA4E,UAAI,QAAJ;AACAwB,YAAM,eADN;AAEAvB,YAAM,UAACwB,MAAD,EAASrG,GAAT,EAAcyG,UAAd,EAA0BC,QAA1B,EAAoClF,OAApC;AACL,YAAAmF,GAAA;;AAAA,aAAAD,YAAA,QAAAC,MAAAD,SAAAE,IAAA,YAAAD,IAAmBnG,IAAnB,GAAmB,MAAnB,GAAmB,MAAnB,KAA2BT,eAAeC,GAAf,EAAoB0G,SAASE,IAAT,CAAcpG,IAAlC,CAA3B;AACCwF,kBAAQM,GAAR,CAAY,2BAAyBtG,IAAIQ,IAAzC;AACA,gBAAM,IAAI+F,OAAOC,KAAX,CAAiB,GAAjB,EAAsB,UAAtB,CAAN;ACyDI;AD9DN;AAAA,KAjBD;AAwBA,2CACC;AAAA5B,UAAI,QAAJ;AACAwB,YAAM,eADN;AAEAvB,YAAM,UAACwB,MAAD,EAASrG,GAAT;AACLA,YAAI2E,OAAJ,GAAc,IAAd;;AACA,YAAG5E,eAAeC,GAAf,CAAH;AACCgG,kBAAQM,GAAR,CAAY,2BAAyBtG,IAAIQ,IAAzC;AACA,gBAAM,IAAI+F,OAAOC,KAAX,CAAiB,GAAjB,EAAsB,aAAWxG,IAAIQ,IAArC,CAAN;AC2DI;ADjEN;AAAA;AAzBD;AAhED,CADD,C","file":"/packages/steedos_object-database.js","sourcesContent":["#TODO objectçš„nameä¸èƒ½é‡å¤ï¼Œéœ€è¦è€ƒè™‘åˆ°ç³»ç»Ÿè¡¨\nisRepeatedName = (doc)->\n\tother = Creator.getCollection(\"objects\").find({_id: {$ne: doc._id}, space: doc.space, name: doc.name}, {fields:{_id: 1}})\n\tif other.count() > 0\n\t\treturn true\n\treturn false\n\nCreator.Objects.objects =\n\tname: \"objects\"\n\ticon: \"orders\"\n\tlabel: \"å¯¹è±¡\"\n\tfields:\n\t\tname:\n\t\t\ttype: \"text\"\n\t\t\tsearchable:true\n\t\t\tindex:true\n\t\t\trequired: true\n\t\t\tregEx: SimpleSchema.RegEx.code\n\t\tlabel:\n\t\t\ttype: \"text\"\n\t\t\trequired: true\n\t\ticon:\n\t\t\ttype: \"lookup\"\n\t\t\toptionsFunction: ()->\n\t\t\t\toptions = []\n\t\t\t\t_.forEach Creator.resources.sldsIcons.standard, (svg)->\n\t\t\t\t\toptions.push {value: svg, label: svg, icon: svg}\n\t\t\t\treturn options\n\t\tis_enable:\n\t\t\ttype: \"boolean\"\n\t\t\tdefaultValue: true\n\t\tenable_search:\n\t\t\ttype: \"boolean\"\n\t\tenable_files:\n\t\t\ttype: \"boolean\"\n\t\tenable_tasks:\n\t\t\ttype: \"boolean\"\n\t\tenable_notes:\n\t\t\ttype: \"boolean\"\n\t\tenable_events:\n\t\t\ttype: \"boolean\"\n\t\tenable_api:\n\t\t\ttype: \"boolean\"\n\t\t\tdefaultValue: true\n\t\t\thidden: true\n\t\tenable_share:\n\t\t\ttype: \"boolean\"\n\t\t\tdefaultValue: false\n\t\tenable_instances:\n\t\t\ttype: \"boolean\"\n\t\tenable_chatter:\n\t\t\ttype: \"boolean\"\n\t\tenable_audit:\n\t\t\ttype: \"boolean\"\n\t\tenable_trash:\n\t\t\ttype: \"boolean\"\n\t\tenable_space_global:\n\t\t\ttype: \"boolean\"\n\t\t\tdefaultValue: false\n\t\tenable_approvals:\n\t\t\ttype: \"boolean\"\n\t\t\tdefaultValue: false\n\t\tis_view:\n\t\t\ttype: 'boolean'\n\t\t\tdefaultValue: false\n\t\t\tomit: true\n\t\thidden:\n\t\t\tlabel: \"éšè—\"\n\t\t\ttype: \"boolean\"\n\t\t\tomit: true\n\t\tdescription:\n\t\t\tlabel: \"Description\"\n\t\t\ttype: \"textarea\"\n\t\t\tis_wide: true\n\t\tsidebar:\n\t\t\ttype: \"object\"\n\t\t\tlabel: \"å·¦ä¾§åˆ—è¡¨\"\n\t\t\tblackbox: true\n\t\t\tomit: true\n\t\t\thidden: true\n\t\tfields:\n\t\t\ttype: \"object\"\n\t\t\tlabel: \"å­—æ®µ\"\n\t\t\tblackbox: true\n\t\t\tomit: true\n\t\t\thidden: true\n\t\tlist_views:\n\t\t\ttype: \"object\"\n\t\t\tlabel: \"åˆ—è¡¨è§†å›¾\"\n\t\t\tblackbox: true\n\t\t\tomit: true\n\t\t\thidden: true\n\t\tactions:\n\t\t\ttype: \"object\"\n\t\t\tlabel: \"æ“ä½œ\"\n\t\t\tblackbox: true\n\t\t\tomit: true\n\t\t\thidden: true\n\t\tpermission_set:\n\t\t\ttype: \"object\"\n\t\t\tlabel: \"æƒé™è®¾ç½®\"\n\t\t\tblackbox: true\n\t\t\tomit: true\n\t\t\thidden: true\n\t\ttriggers:\n\t\t\ttype: \"object\"\n\t\t\tlabel: \"è§¦å‘å™¨\"\n\t\t\tblackbox: true\n\t\t\tomit: true\n\t\t\thidden: true\n\t\tcustom:\n\t\t\tlabel: \"è§„åˆ™\"\n\t\t\ttype: \"boolean\"\n\t\t\tomit: true\n\t\towner:\n\t\t\ttype: \"lookup\"\n\t\t\thidden: true\n\t\tapp_unique_id:\n\t\t\ttype: 'text'\n\t\t\thidden: true\n\t\tapp_version:\n\t\t\ttype: 'text',\n\t\t\thidden: true\n\n\tlist_views:\n\t\tall:\n\t\t\tcolumns: [\"name\", \"label\", \"is_enable\", \"modified\"]\n\t\t\tlabel:\"å…¨éƒ¨\"\n\t\t\tfilter_scope: \"space\"\n\n\tpermission_set:\n\t\tuser:\n\t\t\tallowCreate: false\n\t\t\tallowDelete: false\n\t\t\tallowEdit: false\n\t\t\tallowRead: false\n\t\t\tmodifyAllRecords: false\n\t\t\tviewAllRecords: false\n\t\tadmin:\n\t\t\tallowCreate: true\n\t\t\tallowDelete: true\n\t\t\tallowEdit: true\n\t\t\tallowRead: true\n\t\t\tmodifyAllRecords: true\n\t\t\tviewAllRecords: true\n\n\tactions:\n\t\tcopy_odata:\n\t\t\tlabel: \"å¤åˆ¶ODataç½‘å€\"\n\t\t\tvisible: true\n\t\t\ton: \"record\"\n\t\t\ttodo: (object_name, record_id, item_element)->\n\t\t\t\trecord = Creator.getObjectById(record_id)\n\t\t\t\t#enable_api å±æ€§æœªå¼€æ”¾\n\t\t\t\tif record?.enable_api || true\n\t\t\t\t\to_name = record?.name\n\t\t\t\t\tpath = SteedosOData.getODataPath(Session.get(\"spaceId\"), o_name)\n\t\t\t\t\titem_element.attr('data-clipboard-text', path);\n\t\t\t\t\tif !item_element.attr('data-clipboard-new')\n\t\t\t\t\t\tclipboard = new Clipboard(item_element[0]);\n\t\t\t\t\t\titem_element.attr('data-clipboard-new', true)\n\n\t\t\t\t\t\tclipboard.on('success',  (e) ->\n\t\t\t\t\t\t\ttoastr.success('å¤åˆ¶æˆåŠŸ');\n\t\t\t\t\t\t)\n\t\t\t\t\t\tclipboard.on('error',  (e) ->\n\t\t\t\t\t\t\ttoastr.error('å¤åˆ¶å¤±è´¥');\n\t\t\t\t\t\t\tconsole.error \"e\"\n\t\t\t\t\t\t);\n\t\t\t\t\t\t#fix è¯¦ç»†é¡µé¢(ç½‘é¡µLI æ‰‹æœºç‰ˆview-action)ç¬¬ä¸€æ¬¡ç‚¹å‡»å¤åˆ¶ä¸æ‰§è¡Œ\n\t\t\t\t\t\tif item_element[0].tagName == 'LI' || item_element.hasClass('view-action')\n\t\t\t\t\t\t\titem_element.trigger(\"click\");\n\t\t\t\telse\n\t\t\t\t\ttoastr.error('å¤åˆ¶å¤±è´¥: æœªå¯ç”¨API');\n\n\n\ttriggers:\n\t\t\"before.insert.server.objects\":\n\t\t\ton: \"server\"\n\t\t\twhen: \"before.insert\"\n\t\t\ttodo: (userId, doc)->\n\t\t\t\tif isRepeatedName(doc)\n\t\t\t\t\tconsole.log(\"objectå¯¹è±¡åç§°ä¸èƒ½é‡å¤#{doc.name}\")\n\t\t\t\t\tthrow new Meteor.Error 500, \"å¯¹è±¡åç§°ä¸èƒ½é‡å¤\"\n\t\t\t\tdoc.custom = true\n\n\t\t\"before.update.server.objects\":\n\t\t\ton: \"server\"\n\t\t\twhen: \"before.update\"\n\t\t\ttodo: (userId, doc, fieldNames, modifier, options)->\n\t\t\t\tif modifier?.$set?.name && doc.name != modifier.$set.name\n\t\t\t\t\tconsole.log \"ä¸èƒ½ä¿®æ”¹name\"\n\t\t\t\t\tthrow new Meteor.Error 500, \"ä¸èƒ½ä¿®æ”¹å¯¹è±¡å\"\n\t\t\t\tif modifier.$set\n\t\t\t\t\tmodifier.$set.custom = true\n\n\t\t\t\tif modifier.$unset && modifier.$unset.custom\n\t\t\t\t\tdelete modifier.$unset.custom\n\n\n\t\t\"after.insert.server.objects\":\n\t\t\ton: \"server\"\n\t\t\twhen: \"after.insert\"\n\t\t\ttodo: (userId, doc)->\n\t\t\t\t#æ–°å¢objectæ—¶ï¼Œé»˜è®¤æ–°å»ºä¸€ä¸ªnameå­—æ®µ\n\t\t\t\tCreator.getCollection(\"object_fields\").insert({object: doc.name, owner: userId, name: \"name\", space: doc.space, type: \"text\", required: true, index: true, searchable: true})\n\t\t\t\tCreator.getCollection(\"object_listviews\").insert({name: \"all\", space: doc.space, owner: userId, object_name: doc.name, shared: true, filter_scope: \"space\", columns: [\"name\"]})\n\t\t\t\tCreator.getCollection(\"object_listviews\").insert({name: \"recent\", space: doc.space, owner: userId, object_name: doc.name, shared: true, filter_scope: \"space\", columns: [\"name\"]})\n\n\t\t\"before.remove.server.objects\":\n\t\t\ton: \"server\"\n\t\t\twhen: \"before.remove\"\n\t\t\ttodo: (userId, doc)->\n\n\t\t\t\tif doc.app_unique_id && doc.app_version\n\t\t\t\t\treturn\n\n\t\t\t\tobject_collections = Creator.getCollection(doc.name, doc.space)\n\n\t\t\t\tdocuments = object_collections.find({},{fields: {_id: 1}})\n\n\t\t\t\tif documents.count() > 0\n\t\t\t\t\tthrow new Meteor.Error 500, \"å¯¹è±¡(#{doc.name})ä¸­å·²ç»æœ‰è®°å½•ï¼Œè¯·å…ˆåˆ é™¤è®°å½•åï¼Œ å†åˆ é™¤æ­¤å¯¹è±¡\"\n\n\t\t\"after.remove.server.objects\":\n\t\t\ton: \"server\"\n\t\t\twhen: \"after.remove\"\n\t\t\ttodo: (userId, doc)->\n\t\t\t\t#åˆ é™¤object åï¼Œè‡ªåŠ¨åˆ é™¤fieldsã€actionsã€triggersã€permission_objects\n\t\t\t\tCreator.getCollection(\"object_fields\").direct.remove({object: doc.name, space: doc.space})\n\n\t\t\t\tCreator.getCollection(\"object_actions\").direct.remove({object: doc.name, space: doc.space})\n\n\t\t\t\tCreator.getCollection(\"object_triggers\").direct.remove({object: doc.name, space: doc.space})\n\n\t\t\t\tCreator.getCollection(\"permission_objects\").direct.remove({object_name: doc.name, space: doc.space})\n\n\t\t\t\tCreator.getCollection(\"object_listviews\").direct.remove({object_name: doc.name, space: doc.space})\n\n\t\t\t\t#drop collection\n\t\t\t\tconsole.log \"drop collection\", doc.name\n\t\t\t\ttry\n#\t\t\t\t\tCreator.getCollection(doc.name)._collection.dropCollection()\n\t\t\t\t\tCreator.Collections[\"c_#{doc.space}_#{doc.name}\"]._collection.dropCollection()\n\t\t\t\tcatch e\n\t\t\t\t\tconsole.error(\"c_#{doc.space}_#{doc.name}\", \"#{e.stack}\")\n\t\t\t\t\tthrow new Meteor.Error 500, \"å¯¹è±¡(#{doc.name})ä¸å­˜åœ¨æˆ–å·²è¢«åˆ é™¤\"","var isRepeatedName;\n\nisRepeatedName = function(doc) {\n  var other;\n  other = Creator.getCollection(\"objects\").find({\n    _id: {\n      $ne: doc._id\n    },\n    space: doc.space,\n    name: doc.name\n  }, {\n    fields: {\n      _id: 1\n    }\n  });\n  if (other.count() > 0) {\n    return true;\n  }\n  return false;\n};\n\nCreator.Objects.objects = {\n  name: \"objects\",\n  icon: \"orders\",\n  label: \"å¯¹è±¡\",\n  fields: {\n    name: {\n      type: \"text\",\n      searchable: true,\n      index: true,\n      required: true,\n      regEx: SimpleSchema.RegEx.code\n    },\n    label: {\n      type: \"text\",\n      required: true\n    },\n    icon: {\n      type: \"lookup\",\n      optionsFunction: function() {\n        var options;\n        options = [];\n        _.forEach(Creator.resources.sldsIcons.standard, function(svg) {\n          return options.push({\n            value: svg,\n            label: svg,\n            icon: svg\n          });\n        });\n        return options;\n      }\n    },\n    is_enable: {\n      type: \"boolean\",\n      defaultValue: true\n    },\n    enable_search: {\n      type: \"boolean\"\n    },\n    enable_files: {\n      type: \"boolean\"\n    },\n    enable_tasks: {\n      type: \"boolean\"\n    },\n    enable_notes: {\n      type: \"boolean\"\n    },\n    enable_events: {\n      type: \"boolean\"\n    },\n    enable_api: {\n      type: \"boolean\",\n      defaultValue: true,\n      hidden: true\n    },\n    enable_share: {\n      type: \"boolean\",\n      defaultValue: false\n    },\n    enable_instances: {\n      type: \"boolean\"\n    },\n    enable_chatter: {\n      type: \"boolean\"\n    },\n    enable_audit: {\n      type: \"boolean\"\n    },\n    enable_trash: {\n      type: \"boolean\"\n    },\n    enable_space_global: {\n      type: \"boolean\",\n      defaultValue: false\n    },\n    enable_approvals: {\n      type: \"boolean\",\n      defaultValue: false\n    },\n    is_view: {\n      type: 'boolean',\n      defaultValue: false,\n      omit: true\n    },\n    hidden: {\n      label: \"éšè—\",\n      type: \"boolean\",\n      omit: true\n    },\n    description: {\n      label: \"Description\",\n      type: \"textarea\",\n      is_wide: true\n    },\n    sidebar: {\n      type: \"object\",\n      label: \"å·¦ä¾§åˆ—è¡¨\",\n      blackbox: true,\n      omit: true,\n      hidden: true\n    },\n    fields: {\n      type: \"object\",\n      label: \"å­—æ®µ\",\n      blackbox: true,\n      omit: true,\n      hidden: true\n    },\n    list_views: {\n      type: \"object\",\n      label: \"åˆ—è¡¨è§†å›¾\",\n      blackbox: true,\n      omit: true,\n      hidden: true\n    },\n    actions: {\n      type: \"object\",\n      label: \"æ“ä½œ\",\n      blackbox: true,\n      omit: true,\n      hidden: true\n    },\n    permission_set: {\n      type: \"object\",\n      label: \"æƒé™è®¾ç½®\",\n      blackbox: true,\n      omit: true,\n      hidden: true\n    },\n    triggers: {\n      type: \"object\",\n      label: \"è§¦å‘å™¨\",\n      blackbox: true,\n      omit: true,\n      hidden: true\n    },\n    custom: {\n      label: \"è§„åˆ™\",\n      type: \"boolean\",\n      omit: true\n    },\n    owner: {\n      type: \"lookup\",\n      hidden: true\n    },\n    app_unique_id: {\n      type: 'text',\n      hidden: true\n    },\n    app_version: {\n      type: 'text',\n      hidden: true\n    }\n  },\n  list_views: {\n    all: {\n      columns: [\"name\", \"label\", \"is_enable\", \"modified\"],\n      label: \"å…¨éƒ¨\",\n      filter_scope: \"space\"\n    }\n  },\n  permission_set: {\n    user: {\n      allowCreate: false,\n      allowDelete: false,\n      allowEdit: false,\n      allowRead: false,\n      modifyAllRecords: false,\n      viewAllRecords: false\n    },\n    admin: {\n      allowCreate: true,\n      allowDelete: true,\n      allowEdit: true,\n      allowRead: true,\n      modifyAllRecords: true,\n      viewAllRecords: true\n    }\n  },\n  actions: {\n    copy_odata: {\n      label: \"å¤åˆ¶ODataç½‘å€\",\n      visible: true,\n      on: \"record\",\n      todo: function(object_name, record_id, item_element) {\n        var clipboard, o_name, path, record;\n        record = Creator.getObjectById(record_id);\n        if ((record != null ? record.enable_api : void 0) || true) {\n          o_name = record != null ? record.name : void 0;\n          path = SteedosOData.getODataPath(Session.get(\"spaceId\"), o_name);\n          item_element.attr('data-clipboard-text', path);\n          if (!item_element.attr('data-clipboard-new')) {\n            clipboard = new Clipboard(item_element[0]);\n            item_element.attr('data-clipboard-new', true);\n            clipboard.on('success', function(e) {\n              return toastr.success('å¤åˆ¶æˆåŠŸ');\n            });\n            clipboard.on('error', function(e) {\n              toastr.error('å¤åˆ¶å¤±è´¥');\n              return console.error(\"e\");\n            });\n            if (item_element[0].tagName === 'LI' || item_element.hasClass('view-action')) {\n              return item_element.trigger(\"click\");\n            }\n          }\n        } else {\n          return toastr.error('å¤åˆ¶å¤±è´¥: æœªå¯ç”¨API');\n        }\n      }\n    }\n  },\n  triggers: {\n    \"before.insert.server.objects\": {\n      on: \"server\",\n      when: \"before.insert\",\n      todo: function(userId, doc) {\n        if (isRepeatedName(doc)) {\n          console.log(\"objectå¯¹è±¡åç§°ä¸èƒ½é‡å¤\" + doc.name);\n          throw new Meteor.Error(500, \"å¯¹è±¡åç§°ä¸èƒ½é‡å¤\");\n        }\n        return doc.custom = true;\n      }\n    },\n    \"before.update.server.objects\": {\n      on: \"server\",\n      when: \"before.update\",\n      todo: function(userId, doc, fieldNames, modifier, options) {\n        var ref;\n        if ((modifier != null ? (ref = modifier.$set) != null ? ref.name : void 0 : void 0) && doc.name !== modifier.$set.name) {\n          console.log(\"ä¸èƒ½ä¿®æ”¹name\");\n          throw new Meteor.Error(500, \"ä¸èƒ½ä¿®æ”¹å¯¹è±¡å\");\n        }\n        if (modifier.$set) {\n          modifier.$set.custom = true;\n        }\n        if (modifier.$unset && modifier.$unset.custom) {\n          return delete modifier.$unset.custom;\n        }\n      }\n    },\n    \"after.insert.server.objects\": {\n      on: \"server\",\n      when: \"after.insert\",\n      todo: function(userId, doc) {\n        Creator.getCollection(\"object_fields\").insert({\n          object: doc.name,\n          owner: userId,\n          name: \"name\",\n          space: doc.space,\n          type: \"text\",\n          required: true,\n          index: true,\n          searchable: true\n        });\n        Creator.getCollection(\"object_listviews\").insert({\n          name: \"all\",\n          space: doc.space,\n          owner: userId,\n          object_name: doc.name,\n          shared: true,\n          filter_scope: \"space\",\n          columns: [\"name\"]\n        });\n        return Creator.getCollection(\"object_listviews\").insert({\n          name: \"recent\",\n          space: doc.space,\n          owner: userId,\n          object_name: doc.name,\n          shared: true,\n          filter_scope: \"space\",\n          columns: [\"name\"]\n        });\n      }\n    },\n    \"before.remove.server.objects\": {\n      on: \"server\",\n      when: \"before.remove\",\n      todo: function(userId, doc) {\n        var documents, object_collections;\n        if (doc.app_unique_id && doc.app_version) {\n          return;\n        }\n        object_collections = Creator.getCollection(doc.name, doc.space);\n        documents = object_collections.find({}, {\n          fields: {\n            _id: 1\n          }\n        });\n        if (documents.count() > 0) {\n          throw new Meteor.Error(500, \"å¯¹è±¡(\" + doc.name + \")ä¸­å·²ç»æœ‰è®°å½•ï¼Œè¯·å…ˆåˆ é™¤è®°å½•åï¼Œ å†åˆ é™¤æ­¤å¯¹è±¡\");\n        }\n      }\n    },\n    \"after.remove.server.objects\": {\n      on: \"server\",\n      when: \"after.remove\",\n      todo: function(userId, doc) {\n        var e;\n        Creator.getCollection(\"object_fields\").direct.remove({\n          object: doc.name,\n          space: doc.space\n        });\n        Creator.getCollection(\"object_actions\").direct.remove({\n          object: doc.name,\n          space: doc.space\n        });\n        Creator.getCollection(\"object_triggers\").direct.remove({\n          object: doc.name,\n          space: doc.space\n        });\n        Creator.getCollection(\"permission_objects\").direct.remove({\n          object_name: doc.name,\n          space: doc.space\n        });\n        Creator.getCollection(\"object_listviews\").direct.remove({\n          object_name: doc.name,\n          space: doc.space\n        });\n        console.log(\"drop collection\", doc.name);\n        try {\n          return Creator.Collections[\"c_\" + doc.space + \"_\" + doc.name]._collection.dropCollection();\n        } catch (error) {\n          e = error;\n          console.error(\"c_\" + doc.space + \"_\" + doc.name, \"\" + e.stack);\n          throw new Meteor.Error(500, \"å¯¹è±¡(\" + doc.name + \")ä¸å­˜åœ¨æˆ–å·²è¢«åˆ é™¤\");\n        }\n      }\n    }\n  }\n};\n","_syncToObject = (doc) ->\n\tobject_fields = Creator.getCollection(\"object_fields\").find({space: doc.space, object: doc.object}, {\n\t\tfields: {\n\t\t\tcreated: 0,\n\t\t\tmodified: 0,\n\t\t\towner: 0,\n\t\t\tcreated_by: 0,\n\t\t\tmodified_by: 0\n\t\t}\n\t}).fetch()\n\n\tfields = {}\n\n\ttable_fields = {}\n\n\t_.forEach object_fields, (f)->\n\t\tif /^[a-zA-Z_]\\w*(\\.\\$\\.\\w+){1}[a-zA-Z0-9]*$/.test(f.name)\n\t\t\tcf_arr = f.name.split(\".$.\")\n\t\t\tchild_fields = {}\n\t\t\tchild_fields[cf_arr[1]] = f\n\t\t\tif !_.size(table_fields[cf_arr[0]])\n\t\t\t\ttable_fields[cf_arr[0]] = {}\n\t\t\t_.extend(table_fields[cf_arr[0]], child_fields)\n\t\telse\n\t\t\tfields[f.name] = f\n\n\t_.each table_fields, (f, k)->\n\t\tif fields[k].type == \"grid\"\n\t\t\tif !_.size(fields[k].fields)\n\t\t\t\tfields[k].fields = {}\n\t\t\t_.extend(fields[k].fields, f)\n\n\tCreator.getCollection(\"objects\").update({space: doc.space, name: doc.object}, {\n\t\t$set:\n\t\t\tfields: fields\n\t})\n\nisRepeatedName = (doc, name)->\n\tother = Creator.getCollection(\"object_fields\").find({object: doc.object,  space: doc.space, _id: {$ne: doc._id}, name: name || doc.name}, {fields:{_id: 1}})\n\tif other.count() > 0\n\t\treturn true\n\treturn false\n\nCreator.Objects.object_fields =\n\tname: \"object_fields\"\n\ticon: \"orders\"\n\tenable_api: true\n\tlabel:\"å­—æ®µ\"\n\tfields:\n\t\tname:\n\t\t\ttype: \"text\"\n\t\t\tsearchable: true\n\t\t\tindex: true\n\t\t\trequired: true\n\t\t\tregEx: SimpleSchema.RegEx.field\n\t\tlabel:\n\t\t\ttype: \"text\"\n\t\tis_name:\n\t\t\ttype: \"boolean\"\n\t\t\thidden: true\n\t\tobject:\n\t\t\ttype: \"master_detail\"\n\t\t\treference_to: \"objects\"\n\t\t\trequired: true\n\t\t\toptionsFunction: ()->\n\t\t\t\t_options = []\n\t\t\t\t_.forEach Creator.objectsByName, (o, k)->\n\t\t\t\t\t_options.push {label: o.label, value: k, icon: o.icon}\n\t\t\t\treturn _options\n\t\ttype:\n\t\t\ttype: \"select\"\n#\t\t\trequired: true\n\t\t\toptions:\n\t\t\t\ttext: \"æ–‡æœ¬\",\n\t\t\t\ttextarea: \"é•¿æ–‡æœ¬\"\n\t\t\t\thtml: \"Htmlæ–‡æœ¬\",\n\t\t\t\tselect: \"é€‰æ‹©æ¡†\",\n\t\t\t\tboolean: \"Checkbox\"\n\t\t\t\tdate: \"æ—¥æœŸ\"\n\t\t\t\tdatetime: \"æ—¥æœŸæ—¶é—´\"\n\t\t\t\tnumber: \"æ•°å€¼\"\n\t\t\t\tcurrency: \"é‡‘é¢\"\n\t\t\t\tpassword: \"å¯†ç \"\n\t\t\t\tlookup: \"ç›¸å…³è¡¨\"\n\t\t\t\tmaster_detail: \"ä¸»è¡¨/å­è¡¨\"\n\t\t\t\tgrid: \"è¡¨æ ¼\"\n\t\t\t\turl: \"ç½‘å€\"\n\t\t\t\temail: \"é‚®ä»¶åœ°å€\"\n\t\tsort_no:\n\t\t\tlabel: \"æ’åºå·\"\n\t\t\ttype: \"number\"\n\t\t\tdefaultValue: 100\n\t\t\tscale: 0\n\t\t\tsortable: true\n\n\t\tgroup:\n\t\t\ttype: \"text\"\n\n\t\tdefaultValue:\n\t\t\ttype: \"text\"\n\n\t\tallowedValues:\n\t\t\ttype: \"text\"\n\t\t\tmultiple: true\n\n\t\tmultiple:\n\t\t\ttype: \"boolean\"\n\n\t\trequired:\n\t\t\ttype: \"boolean\"\n\n\t\tis_wide:\n\t\t\ttype: \"boolean\"\n\n\t\treadonly:\n\t\t\ttype: \"boolean\"\n\n#\t\tdisabled:\n#\t\t\ttype: \"boolean\"\n\t\thidden:\n\t\t\ttype: \"boolean\"\n\t\t#TODO å°†æ­¤åŠŸèƒ½å¼€æ”¾ç»™ç”¨æˆ·æ—¶ï¼Œéœ€è¦å…³é—­æ­¤å±æ€§\n\t\tomit:\n\t\t\ttype: \"boolean\"\n\n\t\tindex:\n\t\t\ttype: \"boolean\"\n\n\t\tsearchable:\n\t\t\ttype: \"boolean\"\n\n\t\tsortable:\n\t\t\ttype: \"boolean\"\n\n\t\tprecision:\n\t\t\ttype: \"currency\"\n\t\t\tdefaultValue: 18\n\n\t\tscale:\n\t\t\ttype: \"currency\"\n\t\t\tdefaultValue: 2\n\n\t\treference_to: #åœ¨æœåŠ¡ç«¯å¤„ç†æ­¤å­—æ®µå€¼ï¼Œå¦‚æœå°äº2ä¸ªï¼Œåˆ™å­˜å‚¨ä¸ºå­—ç¬¦ä¸²ï¼Œå¦åˆ™å­˜å‚¨ä¸ºæ•°ç»„\n\t\t\ttype: \"lookup\"\n\t\t\toptionsFunction: ()->\n\t\t\t\t_options = []\n\t\t\t\t_.forEach Creator.Objects, (o, k)->\n\t\t\t\t\t_options.push {label: o.label, value: k, icon: o.icon}\n\t\t\t\treturn _options\n#\t\t\tmultiple: true #å…ˆä¿®æ”¹ä¸ºå•é€‰\n\n\t\trows:\n\t\t\ttype: \"currency\"\n\n\t\toptions:\n\t\t\ttype: \"textarea\"\n\t\t\tis_wide: true\n\n\t\tdescription:\n\t\t\tlabel: \"Description\"\n\t\t\ttype: \"text\"\n\t\t\tis_wide: true\n\n\tlist_views:\n\t\tall:\n\t\t\tcolumns: [\"name\", \"label\", \"type\", \"object\", \"sort_no\", \"modified\"]\n\t\t\tsort: [{field_name: \"sort_no\", order: \"asc\"}]\n\t\t\tfilter_scope: \"space\"\n\n\tpermission_set:\n\t\tuser:\n\t\t\tallowCreate: false\n\t\t\tallowDelete: false\n\t\t\tallowEdit: false\n\t\t\tallowRead: false\n\t\t\tmodifyAllRecords: false\n\t\t\tviewAllRecords: false\n\t\tadmin:\n\t\t\tallowCreate: true\n\t\t\tallowDelete: true\n\t\t\tallowEdit: true\n\t\t\tallowRead: true\n\t\t\tmodifyAllRecords: true\n\t\t\tviewAllRecords: true\n\n\ttriggers:\t\t\t\t\n\t\t\"after.insert.server.object_fields\":\n\t\t\ton: \"server\"\n\t\t\twhen: \"after.insert\"\n\t\t\ttodo: (userId, doc)->\n\t\t\t\t_syncToObject(doc)\n\t\t\"after.update.server.object_fields\":\n\t\t\ton: \"server\"\n\t\t\twhen: \"after.update\"\n\t\t\ttodo: (userId, doc)->\n\t\t\t\t_syncToObject(doc)\n\t\t\"after.remove.server.object_fields\":\n\t\t\ton: \"server\"\n\t\t\twhen: \"after.remove\"\n\t\t\ttodo: (userId, doc)->\n\t\t\t\t_syncToObject(doc)\n\t\t\"before.update.server.object_fields\":\n\t\t\ton: \"server\"\n\t\t\twhen: \"before.update\"\n\t\t\ttodo: (userId, doc, fieldNames, modifier, options)->\n\t\t\t\tif doc.name == 'name' && modifier?.$set?.name && doc.name != modifier.$set.name\n\t\t\t\t\tthrow new Meteor.Error 500, \"ä¸èƒ½ä¿®æ”¹æ­¤çºªå½•çš„nameå±æ€§\"\n\t\t\t\tif modifier?.$set?.name && isRepeatedName(doc, modifier.$set.name)\n\t\t\t\t\tconsole.log(\"update fieldså¯¹è±¡åç§°ä¸èƒ½é‡å¤#{doc.name}\")\n\t\t\t\t\tthrow new Meteor.Error 500, \"å¯¹è±¡åç§°ä¸èƒ½é‡å¤\"\n\n\t\t\t\tif modifier?.$set?.reference_to\n\t\t\t\t\tif modifier.$set.reference_to.length == 1\n\t\t\t\t\t\t_reference_to = modifier.$set.reference_to[0]\n\t\t\t\t\telse\n\t\t\t\t\t\t_reference_to = modifier.$set.reference_to\n\t\t\t\tif modifier?.$set?.index and (modifier?.$set?.type == 'textarea' or modifier?.$set?.type == 'html')\n\t\t\t\t\tthrow new Meteor.Error 500, \"å¤šè¡Œæ–‡æœ¬ä¸æ”¯æŒå»ºç«‹ç´¢å¼•\"\n\t\t\t\tobject = Creator.getCollection(\"objects\").findOne({_id: doc.object}, {fields: {name: 1, label: 1}})\n\n\t\t\t\tif object\n\n\t\t\t\t\tobject_documents = Creator.getCollection(object.name).find()\n\t\t\t\t\tif modifier?.$set?.reference_to && doc.reference_to != _reference_to && object_documents.count() > 0\n\t\t\t\t\t\tthrow new Meteor.Error 500, \"å¯¹è±¡#{object.label}ä¸­å·²ç»æœ‰è®°å½•ï¼Œä¸èƒ½ä¿®æ”¹reference_toå­—æ®µ\"\n\n\t\t\t\t\tif modifier?.$unset?.reference_to && doc.reference_to != _reference_to && object_documents.count() > 0\n\t\t\t\t\t\tthrow new Meteor.Error 500, \"å¯¹è±¡#{object.label}ä¸­å·²ç»æœ‰è®°å½•ï¼Œä¸èƒ½ä¿®æ”¹reference_toå­—æ®µ\"\n#\t\t\t\t\tif modifier?.$set?.reference_to\n#\t\t\t\t\t\tif modifier.$set.reference_to.length == 1\n#\t\t\t\t\t\t\tmodifier.$set.reference_to = modifier.$set.reference_to[0]\n\n\t\t\"before.insert.server.object_fields\":\n\t\t\ton: \"server\"\n\t\t\twhen: \"before.insert\"\n\t\t\ttodo: (userId, doc)->\n\n#\t\t\t\tif doc.reference_to?.length == 1\n#\t\t\t\t\tdoc.reference_to = doc.reference_to[0]\n\n\t\t\t\tif isRepeatedName(doc)\n\t\t\t\t\tconsole.log(\"insert fieldså¯¹è±¡åç§°ä¸èƒ½é‡å¤#{doc.name}\")\n\t\t\t\t\tthrow new Meteor.Error 500, \"å¯¹è±¡åç§°ä¸èƒ½é‡å¤\"\n\t\t\t\tif doc?.index and (doc?.type == 'textarea' or doc?.type == 'html')\n\t\t\t\t\tthrow new Meteor.Error 500,'å¤šè¡Œæ–‡æœ¬ä¸æ”¯æŒå»ºç«‹ç´¢å¼•'\n\t\t\"before.remove.server.object_fields\":\n\t\t\ton: \"server\"\n\t\t\twhen: \"before.remove\"\n\t\t\ttodo: (userId, doc)->\n\t\t\t\tif doc.name == \"name\"\n\t\t\t\t\tthrow new Meteor.Error 500, \"ä¸èƒ½åˆ é™¤æ­¤çºªå½•\"\n\n\n","var _syncToObject, isRepeatedName;\n\n_syncToObject = function(doc) {\n  var fields, object_fields, table_fields;\n  object_fields = Creator.getCollection(\"object_fields\").find({\n    space: doc.space,\n    object: doc.object\n  }, {\n    fields: {\n      created: 0,\n      modified: 0,\n      owner: 0,\n      created_by: 0,\n      modified_by: 0\n    }\n  }).fetch();\n  fields = {};\n  table_fields = {};\n  _.forEach(object_fields, function(f) {\n    var cf_arr, child_fields;\n    if (/^[a-zA-Z_]\\w*(\\.\\$\\.\\w+){1}[a-zA-Z0-9]*$/.test(f.name)) {\n      cf_arr = f.name.split(\".$.\");\n      child_fields = {};\n      child_fields[cf_arr[1]] = f;\n      if (!_.size(table_fields[cf_arr[0]])) {\n        table_fields[cf_arr[0]] = {};\n      }\n      return _.extend(table_fields[cf_arr[0]], child_fields);\n    } else {\n      return fields[f.name] = f;\n    }\n  });\n  _.each(table_fields, function(f, k) {\n    if (fields[k].type === \"grid\") {\n      if (!_.size(fields[k].fields)) {\n        fields[k].fields = {};\n      }\n      return _.extend(fields[k].fields, f);\n    }\n  });\n  return Creator.getCollection(\"objects\").update({\n    space: doc.space,\n    name: doc.object\n  }, {\n    $set: {\n      fields: fields\n    }\n  });\n};\n\nisRepeatedName = function(doc, name) {\n  var other;\n  other = Creator.getCollection(\"object_fields\").find({\n    object: doc.object,\n    space: doc.space,\n    _id: {\n      $ne: doc._id\n    },\n    name: name || doc.name\n  }, {\n    fields: {\n      _id: 1\n    }\n  });\n  if (other.count() > 0) {\n    return true;\n  }\n  return false;\n};\n\nCreator.Objects.object_fields = {\n  name: \"object_fields\",\n  icon: \"orders\",\n  enable_api: true,\n  label: \"å­—æ®µ\",\n  fields: {\n    name: {\n      type: \"text\",\n      searchable: true,\n      index: true,\n      required: true,\n      regEx: SimpleSchema.RegEx.field\n    },\n    label: {\n      type: \"text\"\n    },\n    is_name: {\n      type: \"boolean\",\n      hidden: true\n    },\n    object: {\n      type: \"master_detail\",\n      reference_to: \"objects\",\n      required: true,\n      optionsFunction: function() {\n        var _options;\n        _options = [];\n        _.forEach(Creator.objectsByName, function(o, k) {\n          return _options.push({\n            label: o.label,\n            value: k,\n            icon: o.icon\n          });\n        });\n        return _options;\n      }\n    },\n    type: {\n      type: \"select\",\n      options: {\n        text: \"æ–‡æœ¬\",\n        textarea: \"é•¿æ–‡æœ¬\",\n        html: \"Htmlæ–‡æœ¬\",\n        select: \"é€‰æ‹©æ¡†\",\n        boolean: \"Checkbox\",\n        date: \"æ—¥æœŸ\",\n        datetime: \"æ—¥æœŸæ—¶é—´\",\n        number: \"æ•°å€¼\",\n        currency: \"é‡‘é¢\",\n        password: \"å¯†ç \",\n        lookup: \"ç›¸å…³è¡¨\",\n        master_detail: \"ä¸»è¡¨/å­è¡¨\",\n        grid: \"è¡¨æ ¼\",\n        url: \"ç½‘å€\",\n        email: \"é‚®ä»¶åœ°å€\"\n      }\n    },\n    sort_no: {\n      label: \"æ’åºå·\",\n      type: \"number\",\n      defaultValue: 100,\n      scale: 0,\n      sortable: true\n    },\n    group: {\n      type: \"text\"\n    },\n    defaultValue: {\n      type: \"text\"\n    },\n    allowedValues: {\n      type: \"text\",\n      multiple: true\n    },\n    multiple: {\n      type: \"boolean\"\n    },\n    required: {\n      type: \"boolean\"\n    },\n    is_wide: {\n      type: \"boolean\"\n    },\n    readonly: {\n      type: \"boolean\"\n    },\n    hidden: {\n      type: \"boolean\"\n    },\n    omit: {\n      type: \"boolean\"\n    },\n    index: {\n      type: \"boolean\"\n    },\n    searchable: {\n      type: \"boolean\"\n    },\n    sortable: {\n      type: \"boolean\"\n    },\n    precision: {\n      type: \"currency\",\n      defaultValue: 18\n    },\n    scale: {\n      type: \"currency\",\n      defaultValue: 2\n    },\n    reference_to: {\n      type: \"lookup\",\n      optionsFunction: function() {\n        var _options;\n        _options = [];\n        _.forEach(Creator.Objects, function(o, k) {\n          return _options.push({\n            label: o.label,\n            value: k,\n            icon: o.icon\n          });\n        });\n        return _options;\n      }\n    },\n    rows: {\n      type: \"currency\"\n    },\n    options: {\n      type: \"textarea\",\n      is_wide: true\n    },\n    description: {\n      label: \"Description\",\n      type: \"text\",\n      is_wide: true\n    }\n  },\n  list_views: {\n    all: {\n      columns: [\"name\", \"label\", \"type\", \"object\", \"sort_no\", \"modified\"],\n      sort: [\n        {\n          field_name: \"sort_no\",\n          order: \"asc\"\n        }\n      ],\n      filter_scope: \"space\"\n    }\n  },\n  permission_set: {\n    user: {\n      allowCreate: false,\n      allowDelete: false,\n      allowEdit: false,\n      allowRead: false,\n      modifyAllRecords: false,\n      viewAllRecords: false\n    },\n    admin: {\n      allowCreate: true,\n      allowDelete: true,\n      allowEdit: true,\n      allowRead: true,\n      modifyAllRecords: true,\n      viewAllRecords: true\n    }\n  },\n  triggers: {\n    \"after.insert.server.object_fields\": {\n      on: \"server\",\n      when: \"after.insert\",\n      todo: function(userId, doc) {\n        return _syncToObject(doc);\n      }\n    },\n    \"after.update.server.object_fields\": {\n      on: \"server\",\n      when: \"after.update\",\n      todo: function(userId, doc) {\n        return _syncToObject(doc);\n      }\n    },\n    \"after.remove.server.object_fields\": {\n      on: \"server\",\n      when: \"after.remove\",\n      todo: function(userId, doc) {\n        return _syncToObject(doc);\n      }\n    },\n    \"before.update.server.object_fields\": {\n      on: \"server\",\n      when: \"before.update\",\n      todo: function(userId, doc, fieldNames, modifier, options) {\n        var _reference_to, object, object_documents, ref, ref1, ref2, ref3, ref4, ref5, ref6, ref7;\n        if (doc.name === 'name' && (modifier != null ? (ref = modifier.$set) != null ? ref.name : void 0 : void 0) && doc.name !== modifier.$set.name) {\n          throw new Meteor.Error(500, \"ä¸èƒ½ä¿®æ”¹æ­¤çºªå½•çš„nameå±æ€§\");\n        }\n        if ((modifier != null ? (ref1 = modifier.$set) != null ? ref1.name : void 0 : void 0) && isRepeatedName(doc, modifier.$set.name)) {\n          console.log(\"update fieldså¯¹è±¡åç§°ä¸èƒ½é‡å¤\" + doc.name);\n          throw new Meteor.Error(500, \"å¯¹è±¡åç§°ä¸èƒ½é‡å¤\");\n        }\n        if (modifier != null ? (ref2 = modifier.$set) != null ? ref2.reference_to : void 0 : void 0) {\n          if (modifier.$set.reference_to.length === 1) {\n            _reference_to = modifier.$set.reference_to[0];\n          } else {\n            _reference_to = modifier.$set.reference_to;\n          }\n        }\n        if ((modifier != null ? (ref3 = modifier.$set) != null ? ref3.index : void 0 : void 0) && ((modifier != null ? (ref4 = modifier.$set) != null ? ref4.type : void 0 : void 0) === 'textarea' || (modifier != null ? (ref5 = modifier.$set) != null ? ref5.type : void 0 : void 0) === 'html')) {\n          throw new Meteor.Error(500, \"å¤šè¡Œæ–‡æœ¬ä¸æ”¯æŒå»ºç«‹ç´¢å¼•\");\n        }\n        object = Creator.getCollection(\"objects\").findOne({\n          _id: doc.object\n        }, {\n          fields: {\n            name: 1,\n            label: 1\n          }\n        });\n        if (object) {\n          object_documents = Creator.getCollection(object.name).find();\n          if ((modifier != null ? (ref6 = modifier.$set) != null ? ref6.reference_to : void 0 : void 0) && doc.reference_to !== _reference_to && object_documents.count() > 0) {\n            throw new Meteor.Error(500, \"å¯¹è±¡\" + object.label + \"ä¸­å·²ç»æœ‰è®°å½•ï¼Œä¸èƒ½ä¿®æ”¹reference_toå­—æ®µ\");\n          }\n          if ((modifier != null ? (ref7 = modifier.$unset) != null ? ref7.reference_to : void 0 : void 0) && doc.reference_to !== _reference_to && object_documents.count() > 0) {\n            throw new Meteor.Error(500, \"å¯¹è±¡\" + object.label + \"ä¸­å·²ç»æœ‰è®°å½•ï¼Œä¸èƒ½ä¿®æ”¹reference_toå­—æ®µ\");\n          }\n        }\n      }\n    },\n    \"before.insert.server.object_fields\": {\n      on: \"server\",\n      when: \"before.insert\",\n      todo: function(userId, doc) {\n        if (isRepeatedName(doc)) {\n          console.log(\"insert fieldså¯¹è±¡åç§°ä¸èƒ½é‡å¤\" + doc.name);\n          throw new Meteor.Error(500, \"å¯¹è±¡åç§°ä¸èƒ½é‡å¤\");\n        }\n        if ((doc != null ? doc.index : void 0) && ((doc != null ? doc.type : void 0) === 'textarea' || (doc != null ? doc.type : void 0) === 'html')) {\n          throw new Meteor.Error(500, 'å¤šè¡Œæ–‡æœ¬ä¸æ”¯æŒå»ºç«‹ç´¢å¼•');\n        }\n      }\n    },\n    \"before.remove.server.object_fields\": {\n      on: \"server\",\n      when: \"before.remove\",\n      todo: function(userId, doc) {\n        if (doc.name === \"name\") {\n          throw new Meteor.Error(500, \"ä¸èƒ½åˆ é™¤æ­¤çºªå½•\");\n        }\n      }\n    }\n  }\n};\n","_syncToObject = (doc) ->\n\tobject_triggers = Creator.getCollection(\"object_triggers\").find({space: doc.space, object: doc.object, is_enable: true}, {\n\t\tfields: {\n\t\t\tcreated: 0,\n\t\t\tmodified: 0,\n\t\t\towner: 0,\n\t\t\tcreated_by: 0,\n\t\t\tmodified_by: 0\n\t\t}\n\t}).fetch()\n\n\ttriggers = {}\n\n\t_.forEach object_triggers, (f)->\n\t\ttriggers[f.name] = f\n\n\tCreator.getCollection(\"objects\").update({space: doc.space, name: doc.object}, {\n\t\t$set:\n\t\t\ttriggers: triggers\n\t})\n\nisRepeatedName = (doc, name)->\n\tother = Creator.getCollection(\"object_triggers\").find({object: doc.object,  space: doc.space, _id: {$ne: doc._id}, name: name || doc.name}, {fields:{_id: 1}})\n\tif other.count() > 0\n\t\treturn true\n\treturn false\n\ncheck = (userId, doc)->\n\tif Steedos.isSpaceAdmin(userId, doc.space)\n\t\tthrow new Meteor.Error 500, \"åªæœ‰å·¥ä½œå»ç®¡ç†å‘˜æ‰èƒ½é…ç½®è§¦å‘å™¨\"\n\n\t#TODO æ ¡éªŒå…³é”®å­—ï¼šremoveã€ dropã€deleteã€dbã€collectionã€evalç­‰ï¼Œç„¶åå–æ¶ˆ ä¼ä¸šç‰ˆç‰ˆé™åˆ¶\n\tif doc.on == 'server' && !Steedos.isLegalVersion(doc.space,\"workflow.enterprise\")\n\t\tthrow new Meteor.Error 500, \"åªæœ‰ä¼ä¸šç‰ˆæ”¯æŒé…ç½®æœåŠ¡ç«¯çš„è§¦å‘å™¨\"\n\nCreator.Objects.object_triggers =\n\tname: \"object_triggers\"\n\ticon: \"asset_relationship\"\n\tlabel:\"è§¦å‘å™¨\"\n\tfields:\n\t\tname:\n\t\t\ttype: \"text\"\n\t\t\tsearchable: true\n\t\t\tindex: true\n\t\t\trequired: true\n\t\t\tregEx: SimpleSchema.RegEx.code\n\t\tlabel:\n\t\t\ttype: \"text\"\n\t\tobject:\n\t\t\ttype: \"master_detail\"\n\t\t\treference_to: \"objects\"\n\t\t\trequired: true\n\t\t\toptionsFunction: ()->\n\t\t\t\t_options = []\n\t\t\t\t_.forEach Creator.objectsByName, (o, k)->\n\t\t\t\t\t_options.push {label: o.label, value: k, icon: o.icon}\n\t\t\t\treturn _options\n\t\ton:\n\t\t\ttype: \"lookup\"\n\t\t\trequired: true\n\t\t\toptionsFunction: ()->\n\t\t\t\treturn [{label: \"å®¢æˆ·ç«¯\", value: \"client\", icon: \"address\"}, {label: \"æœåŠ¡ç«¯\", value: \"server\", icon: \"address\"}]\n\t\twhen:\n\t\t\ttype: \"lookup\"\n\t\t\trequired: true\n\t\t\toptionsFunction: ()->\n\t\t\t\t[\n\t\t\t\t\t{label: \"æ–°å¢è®°å½•ä¹‹å‰\", value: \"before.insert\", icon: \"asset_relationship\"}\n\t\t\t\t\t{label: \"æ–°å¢è®°å½•ä¹‹å\", value: \"after.insert\", icon: \"asset_relationship\"}\n\t\t\t\t\t{label: \"ä¿®æ”¹è®°å½•ä¹‹å‰\", value: \"before.update\", icon: \"asset_relationship\"}\n\t\t\t\t\t{label: \"ä¿®æ”¹è®°å½•ä¹‹å\", value: \"after.update\", icon: \"asset_relationship\"}\n\t\t\t\t\t{label: \"åˆ é™¤è®°å½•ä¹‹å‰\", value: \"before.remove\", icon: \"asset_relationship\"}\n\t\t\t\t\t{label: \"åˆ é™¤è®°å½•ä¹‹å\", value: \"after.remove\", icon: \"asset_relationship\"}\n\t\t\t\t]\n\t\tis_enable:\n\t\t\ttype: \"boolean\"\n\t\ttodo:\n\t\t\ttype: \"textarea\"\n\t\t\trequired: true\n\t\t\tis_wide:true\n\n\tlist_views:\n\t\tall:\n\t\t\tcolumns: [\"name\", \"label\", \"object\", \"on\", \"when\", \"is_enable\"]\n\t\t\tfilter_scope: \"space\"\n\n\tpermission_set:\n\t\tuser:\n\t\t\tallowCreate: false\n\t\t\tallowDelete: false\n\t\t\tallowEdit: false\n\t\t\tallowRead: false\n\t\t\tmodifyAllRecords: false\n\t\t\tviewAllRecords: false\n\t\tadmin:\n\t\t\tallowCreate: true\n\t\t\tallowDelete: true\n\t\t\tallowEdit: true\n\t\t\tallowRead: true\n\t\t\tmodifyAllRecords: true\n\t\t\tviewAllRecords: true\n\n\ttriggers:\n\t\t\"after.insert.server.object_triggers\":\n\t\t\ton: \"server\"\n\t\t\twhen: \"after.insert\"\n\t\t\ttodo: (userId, doc)->\n\t\t\t\t_syncToObject(doc)\n\t\t\"after.update.server.object_triggers\":\n\t\t\ton: \"server\"\n\t\t\twhen: \"after.update\"\n\t\t\ttodo: (userId, doc)->\n\t\t\t\t_syncToObject(doc)\n\t\t\"after.remove.server.object_triggers\":\n\t\t\ton: \"server\"\n\t\t\twhen: \"after.remove\"\n\t\t\ttodo: (userId, doc)->\n\t\t\t\t_syncToObject(doc)\n\n\t\t\"before.delete.server.object_triggers\":\n\t\t\ton: \"server\"\n\t\t\twhen: \"before.remove\"\n\t\t\ttodo: (userId, doc)->\n\t\t\t\tcheck(userId, doc)\n\n\t\t\"before.update.server.object_triggers\":\n\t\t\ton: \"server\"\n\t\t\twhen: \"before.update\"\n\t\t\ttodo: (userId, doc, fieldNames, modifier, options)->\n\t\t\t\tcheck(userId, doc)\n\t\t\t\tif modifier?.$set?.name && isRepeatedName(doc, modifier.$set.name)\n\t\t\t\t\tconsole.log(\"update triggerså¯¹è±¡åç§°ä¸èƒ½é‡å¤#{doc.name}\")\n\t\t\t\t\tthrow new Meteor.Error 500, \"å¯¹è±¡åç§°ä¸èƒ½é‡å¤#{doc.name}\"\n\n\t\t\"before.insert.server.object_triggers\":\n\t\t\ton: \"server\"\n\t\t\twhen: \"before.insert\"\n\t\t\ttodo: (userId, doc)->\n\t\t\t\tcheck(userId, doc)\n\t\t\t\tif isRepeatedName(doc)\n\t\t\t\t\tconsole.log(\"insert triggerså¯¹è±¡åç§°ä¸èƒ½é‡å¤#{doc.name}\")\n\t\t\t\t\tthrow new Meteor.Error 500, \"å¯¹è±¡åç§°ä¸èƒ½é‡å¤\"","var _syncToObject, check, isRepeatedName;\n\n_syncToObject = function(doc) {\n  var object_triggers, triggers;\n  object_triggers = Creator.getCollection(\"object_triggers\").find({\n    space: doc.space,\n    object: doc.object,\n    is_enable: true\n  }, {\n    fields: {\n      created: 0,\n      modified: 0,\n      owner: 0,\n      created_by: 0,\n      modified_by: 0\n    }\n  }).fetch();\n  triggers = {};\n  _.forEach(object_triggers, function(f) {\n    return triggers[f.name] = f;\n  });\n  return Creator.getCollection(\"objects\").update({\n    space: doc.space,\n    name: doc.object\n  }, {\n    $set: {\n      triggers: triggers\n    }\n  });\n};\n\nisRepeatedName = function(doc, name) {\n  var other;\n  other = Creator.getCollection(\"object_triggers\").find({\n    object: doc.object,\n    space: doc.space,\n    _id: {\n      $ne: doc._id\n    },\n    name: name || doc.name\n  }, {\n    fields: {\n      _id: 1\n    }\n  });\n  if (other.count() > 0) {\n    return true;\n  }\n  return false;\n};\n\ncheck = function(userId, doc) {\n  if (Steedos.isSpaceAdmin(userId, doc.space)) {\n    throw new Meteor.Error(500, \"åªæœ‰å·¥ä½œå»ç®¡ç†å‘˜æ‰èƒ½é…ç½®è§¦å‘å™¨\");\n  }\n  if (doc.on === 'server' && !Steedos.isLegalVersion(doc.space, \"workflow.enterprise\")) {\n    throw new Meteor.Error(500, \"åªæœ‰ä¼ä¸šç‰ˆæ”¯æŒé…ç½®æœåŠ¡ç«¯çš„è§¦å‘å™¨\");\n  }\n};\n\nCreator.Objects.object_triggers = {\n  name: \"object_triggers\",\n  icon: \"asset_relationship\",\n  label: \"è§¦å‘å™¨\",\n  fields: {\n    name: {\n      type: \"text\",\n      searchable: true,\n      index: true,\n      required: true,\n      regEx: SimpleSchema.RegEx.code\n    },\n    label: {\n      type: \"text\"\n    },\n    object: {\n      type: \"master_detail\",\n      reference_to: \"objects\",\n      required: true,\n      optionsFunction: function() {\n        var _options;\n        _options = [];\n        _.forEach(Creator.objectsByName, function(o, k) {\n          return _options.push({\n            label: o.label,\n            value: k,\n            icon: o.icon\n          });\n        });\n        return _options;\n      }\n    },\n    on: {\n      type: \"lookup\",\n      required: true,\n      optionsFunction: function() {\n        return [\n          {\n            label: \"å®¢æˆ·ç«¯\",\n            value: \"client\",\n            icon: \"address\"\n          }, {\n            label: \"æœåŠ¡ç«¯\",\n            value: \"server\",\n            icon: \"address\"\n          }\n        ];\n      }\n    },\n    when: {\n      type: \"lookup\",\n      required: true,\n      optionsFunction: function() {\n        return [\n          {\n            label: \"æ–°å¢è®°å½•ä¹‹å‰\",\n            value: \"before.insert\",\n            icon: \"asset_relationship\"\n          }, {\n            label: \"æ–°å¢è®°å½•ä¹‹å\",\n            value: \"after.insert\",\n            icon: \"asset_relationship\"\n          }, {\n            label: \"ä¿®æ”¹è®°å½•ä¹‹å‰\",\n            value: \"before.update\",\n            icon: \"asset_relationship\"\n          }, {\n            label: \"ä¿®æ”¹è®°å½•ä¹‹å\",\n            value: \"after.update\",\n            icon: \"asset_relationship\"\n          }, {\n            label: \"åˆ é™¤è®°å½•ä¹‹å‰\",\n            value: \"before.remove\",\n            icon: \"asset_relationship\"\n          }, {\n            label: \"åˆ é™¤è®°å½•ä¹‹å\",\n            value: \"after.remove\",\n            icon: \"asset_relationship\"\n          }\n        ];\n      }\n    },\n    is_enable: {\n      type: \"boolean\"\n    },\n    todo: {\n      type: \"textarea\",\n      required: true,\n      is_wide: true\n    }\n  },\n  list_views: {\n    all: {\n      columns: [\"name\", \"label\", \"object\", \"on\", \"when\", \"is_enable\"],\n      filter_scope: \"space\"\n    }\n  },\n  permission_set: {\n    user: {\n      allowCreate: false,\n      allowDelete: false,\n      allowEdit: false,\n      allowRead: false,\n      modifyAllRecords: false,\n      viewAllRecords: false\n    },\n    admin: {\n      allowCreate: true,\n      allowDelete: true,\n      allowEdit: true,\n      allowRead: true,\n      modifyAllRecords: true,\n      viewAllRecords: true\n    }\n  },\n  triggers: {\n    \"after.insert.server.object_triggers\": {\n      on: \"server\",\n      when: \"after.insert\",\n      todo: function(userId, doc) {\n        return _syncToObject(doc);\n      }\n    },\n    \"after.update.server.object_triggers\": {\n      on: \"server\",\n      when: \"after.update\",\n      todo: function(userId, doc) {\n        return _syncToObject(doc);\n      }\n    },\n    \"after.remove.server.object_triggers\": {\n      on: \"server\",\n      when: \"after.remove\",\n      todo: function(userId, doc) {\n        return _syncToObject(doc);\n      }\n    },\n    \"before.delete.server.object_triggers\": {\n      on: \"server\",\n      when: \"before.remove\",\n      todo: function(userId, doc) {\n        return check(userId, doc);\n      }\n    },\n    \"before.update.server.object_triggers\": {\n      on: \"server\",\n      when: \"before.update\",\n      todo: function(userId, doc, fieldNames, modifier, options) {\n        var ref;\n        check(userId, doc);\n        if ((modifier != null ? (ref = modifier.$set) != null ? ref.name : void 0 : void 0) && isRepeatedName(doc, modifier.$set.name)) {\n          console.log(\"update triggerså¯¹è±¡åç§°ä¸èƒ½é‡å¤\" + doc.name);\n          throw new Meteor.Error(500, \"å¯¹è±¡åç§°ä¸èƒ½é‡å¤\" + doc.name);\n        }\n      }\n    },\n    \"before.insert.server.object_triggers\": {\n      on: \"server\",\n      when: \"before.insert\",\n      todo: function(userId, doc) {\n        check(userId, doc);\n        if (isRepeatedName(doc)) {\n          console.log(\"insert triggerså¯¹è±¡åç§°ä¸èƒ½é‡å¤\" + doc.name);\n          throw new Meteor.Error(500, \"å¯¹è±¡åç§°ä¸èƒ½é‡å¤\");\n        }\n      }\n    }\n  }\n};\n","_syncToObject = (doc) ->\n\tobject_actions = Creator.getCollection(\"object_actions\").find({object: doc.object, space: doc.space, is_enable: true}, {\n\t\tfields: {\n\t\t\tcreated: 0,\n\t\t\tmodified: 0,\n\t\t\towner: 0,\n\t\t\tcreated_by: 0,\n\t\t\tmodified_by: 0\n\t\t}\n\t}).fetch()\n\n\tactions = {}\n\n\t_.forEach object_actions, (f)->\n\t\tactions[f.name] = f\n\n\tCreator.getCollection(\"objects\").update({space: doc.space, name: doc.object}, {\n\t\t$set:\n\t\t\tactions: actions\n\t})\nisRepeatedName = (doc, name)->\n\tother = Creator.getCollection(\"object_actions\").find({object: doc.object,  space: doc.space, _id: {$ne: doc._id}, name: name || doc.name}, {fields:{_id: 1}})\n\tif other.count() > 0\n\t\treturn true\n\treturn false\nCreator.Objects.object_actions =\n\tname: \"object_actions\"\n\tlabel: \"å¯¹è±¡æ“ä½œ\"\n\ticon: \"marketing_actions\"\n\tfields:\n\t\tobject:\n\t\t\ttype: \"master_detail\"\n\t\t\treference_to: \"objects\"\n\t\t\trequired: true\n\t\t\toptionsFunction: ()->\n\t\t\t\t_options = []\n\t\t\t\t_.forEach Creator.objectsByName, (o, k)->\n\t\t\t\t\t_options.push {label: o.label, value: k, icon: o.icon}\n\t\t\t\treturn _options\n\t\tname:\n\t\t\ttype: \"text\"\n\t\t\tsearchable:true\n\t\t\tindex:true\n\t\t\trequired: true\n\t\t\tregEx: SimpleSchema.RegEx.code\n\t\tlabel:\n\t\t\ttype: \"text\"\n\t\tis_enable:\n\t\t\ttype: \"boolean\"\n\t\tvisible:\n\t\t\ttype: \"boolean\"\n\t\t\tomit: true\n\t\ton:\n\t\t\ttype: \"lookup\"\n\t\t\tis_wide:true\n\t\t\trequired: true\n\t\t\toptionsFunction: ()->\n\t\t\t\t[\n\t\t\t\t\t{label: \"æ˜¾ç¤ºåœ¨åˆ—è¡¨å³ä¸Šè§’\", value: \"list\", icon: \"contact_list\"}\n\t\t\t\t\t{label: \"æ˜¾ç¤ºåœ¨è®°å½•æŸ¥çœ‹é¡µå³ä¸Šè§’\", value: \"record\", icon: \"contract\"}\n\t\t\t\t]\n\t\ttodo:\n\t\t\tlabel: \"æ‰§è¡Œçš„è„šæœ¬\"\n\t\t\ttype: \"textarea\"\n\t\t\trequired: true\n\t\t\tis_wide:true\n\n\n\tlist_views:\n\t\tall:\n\t\t\tcolumns: [\"name\", \"label\", \"object\", \"on\", \"is_enable\", \"modified\"]\n\t\t\tfilter_scope: \"space\"\n\n\tpermission_set:\n\t\tuser:\n\t\t\tallowCreate: false\n\t\t\tallowDelete: false\n\t\t\tallowEdit: false\n\t\t\tallowRead: false\n\t\t\tmodifyAllRecords: false\n\t\t\tviewAllRecords: false\n\t\tadmin:\n\t\t\tallowCreate: true\n\t\t\tallowDelete: true\n\t\t\tallowEdit: true\n\t\t\tallowRead: true\n\t\t\tmodifyAllRecords: true\n\t\t\tviewAllRecords: true\n\n\ttriggers:\n\t\t\"after.insert.server.object_actions\":\n\t\t\ton: \"server\"\n\t\t\twhen: \"after.insert\"\n\t\t\ttodo: (userId, doc)->\n\t\t\t\t_syncToObject(doc)\n\t\t\"after.update.server.object_actions\":\n\t\t\ton: \"server\"\n\t\t\twhen: \"after.update\"\n\t\t\ttodo: (userId, doc)->\n\t\t\t\t_syncToObject(doc)\n\t\t\"after.remove.server.object_actions\":\n\t\t\ton: \"server\"\n\t\t\twhen: \"after.remove\"\n\t\t\ttodo: (userId, doc)->\n\t\t\t\t_syncToObject(doc)\n\n\t\t\"before.update.server.object_actions\":\n\t\t\ton: \"server\"\n\t\t\twhen: \"before.update\"\n\t\t\ttodo: (userId, doc, fieldNames, modifier, options)->\n\t\t\t\tif modifier?.$set?.name && isRepeatedName(doc, modifier.$set.name)\n\t\t\t\t\tconsole.log(\"update actionså¯¹è±¡åç§°ä¸èƒ½é‡å¤#{doc.name}\")\n\t\t\t\t\tthrow new Meteor.Error 500, \"å¯¹è±¡åç§°ä¸èƒ½é‡å¤\"\n\n\t\t\"before.insert.server.object_actions\":\n\t\t\ton: \"server\"\n\t\t\twhen: \"before.insert\"\n\t\t\ttodo: (userId, doc)->\n\t\t\t\tdoc.visible = true\n\t\t\t\tif isRepeatedName(doc)\n\t\t\t\t\tconsole.log(\"insert actionså¯¹è±¡åç§°ä¸èƒ½é‡å¤#{doc.name}\")\n\t\t\t\t\tthrow new Meteor.Error 500, \"å¯¹è±¡åç§°ä¸èƒ½é‡å¤#{doc.name}\"","var _syncToObject, isRepeatedName;\n\n_syncToObject = function(doc) {\n  var actions, object_actions;\n  object_actions = Creator.getCollection(\"object_actions\").find({\n    object: doc.object,\n    space: doc.space,\n    is_enable: true\n  }, {\n    fields: {\n      created: 0,\n      modified: 0,\n      owner: 0,\n      created_by: 0,\n      modified_by: 0\n    }\n  }).fetch();\n  actions = {};\n  _.forEach(object_actions, function(f) {\n    return actions[f.name] = f;\n  });\n  return Creator.getCollection(\"objects\").update({\n    space: doc.space,\n    name: doc.object\n  }, {\n    $set: {\n      actions: actions\n    }\n  });\n};\n\nisRepeatedName = function(doc, name) {\n  var other;\n  other = Creator.getCollection(\"object_actions\").find({\n    object: doc.object,\n    space: doc.space,\n    _id: {\n      $ne: doc._id\n    },\n    name: name || doc.name\n  }, {\n    fields: {\n      _id: 1\n    }\n  });\n  if (other.count() > 0) {\n    return true;\n  }\n  return false;\n};\n\nCreator.Objects.object_actions = {\n  name: \"object_actions\",\n  label: \"å¯¹è±¡æ“ä½œ\",\n  icon: \"marketing_actions\",\n  fields: {\n    object: {\n      type: \"master_detail\",\n      reference_to: \"objects\",\n      required: true,\n      optionsFunction: function() {\n        var _options;\n        _options = [];\n        _.forEach(Creator.objectsByName, function(o, k) {\n          return _options.push({\n            label: o.label,\n            value: k,\n            icon: o.icon\n          });\n        });\n        return _options;\n      }\n    },\n    name: {\n      type: \"text\",\n      searchable: true,\n      index: true,\n      required: true,\n      regEx: SimpleSchema.RegEx.code\n    },\n    label: {\n      type: \"text\"\n    },\n    is_enable: {\n      type: \"boolean\"\n    },\n    visible: {\n      type: \"boolean\",\n      omit: true\n    },\n    on: {\n      type: \"lookup\",\n      is_wide: true,\n      required: true,\n      optionsFunction: function() {\n        return [\n          {\n            label: \"æ˜¾ç¤ºåœ¨åˆ—è¡¨å³ä¸Šè§’\",\n            value: \"list\",\n            icon: \"contact_list\"\n          }, {\n            label: \"æ˜¾ç¤ºåœ¨è®°å½•æŸ¥çœ‹é¡µå³ä¸Šè§’\",\n            value: \"record\",\n            icon: \"contract\"\n          }\n        ];\n      }\n    },\n    todo: {\n      label: \"æ‰§è¡Œçš„è„šæœ¬\",\n      type: \"textarea\",\n      required: true,\n      is_wide: true\n    }\n  },\n  list_views: {\n    all: {\n      columns: [\"name\", \"label\", \"object\", \"on\", \"is_enable\", \"modified\"],\n      filter_scope: \"space\"\n    }\n  },\n  permission_set: {\n    user: {\n      allowCreate: false,\n      allowDelete: false,\n      allowEdit: false,\n      allowRead: false,\n      modifyAllRecords: false,\n      viewAllRecords: false\n    },\n    admin: {\n      allowCreate: true,\n      allowDelete: true,\n      allowEdit: true,\n      allowRead: true,\n      modifyAllRecords: true,\n      viewAllRecords: true\n    }\n  },\n  triggers: {\n    \"after.insert.server.object_actions\": {\n      on: \"server\",\n      when: \"after.insert\",\n      todo: function(userId, doc) {\n        return _syncToObject(doc);\n      }\n    },\n    \"after.update.server.object_actions\": {\n      on: \"server\",\n      when: \"after.update\",\n      todo: function(userId, doc) {\n        return _syncToObject(doc);\n      }\n    },\n    \"after.remove.server.object_actions\": {\n      on: \"server\",\n      when: \"after.remove\",\n      todo: function(userId, doc) {\n        return _syncToObject(doc);\n      }\n    },\n    \"before.update.server.object_actions\": {\n      on: \"server\",\n      when: \"before.update\",\n      todo: function(userId, doc, fieldNames, modifier, options) {\n        var ref;\n        if ((modifier != null ? (ref = modifier.$set) != null ? ref.name : void 0 : void 0) && isRepeatedName(doc, modifier.$set.name)) {\n          console.log(\"update actionså¯¹è±¡åç§°ä¸èƒ½é‡å¤\" + doc.name);\n          throw new Meteor.Error(500, \"å¯¹è±¡åç§°ä¸èƒ½é‡å¤\");\n        }\n      }\n    },\n    \"before.insert.server.object_actions\": {\n      on: \"server\",\n      when: \"before.insert\",\n      todo: function(userId, doc) {\n        doc.visible = true;\n        if (isRepeatedName(doc)) {\n          console.log(\"insert actionså¯¹è±¡åç§°ä¸èƒ½é‡å¤\" + doc.name);\n          throw new Meteor.Error(500, \"å¯¹è±¡åç§°ä¸èƒ½é‡å¤\" + doc.name);\n        }\n      }\n    }\n  }\n};\n"]}